<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parkexpert - Otopark Fizibilite Hesaplama</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        :root {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --bg-color: #f5f7fa;
            --card-bg: #ffffff;
            --text-color: #1e3c72;
            --text-secondary: #6c757d;
            --border-color: #e9ecef;
            --success-color: #28a745;
            --danger-color: #dc3545;
            --warning-color: #ffc107;
            --header-bg: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
        }

        [data-theme="dark"] {
            --primary-color: #667eea;
            --secondary-color: #764ba2;
            --bg-color: #1a1a2e;
            --card-bg: #16213e;
            --text-color: #eaeaea;
            --text-secondary: #a0a0a0;
            --border-color: #2d3748;
            --success-color: #48bb78;
            --danger-color: #f56565;
            --warning-color: #ed8936;
            --header-bg: linear-gradient(135deg, #0f3460 0%, #16213e 100%);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--header-bg);
            min-height: 100vh;
            padding: 20px;
            transition: background 0.3s ease;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: var(--card-bg);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
            transition: background 0.3s ease;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
        }

        .logo-container img {
            max-height: 80px;
            max-width: 200px;
            object-fit: contain;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 16px;
            opacity: 0.9;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .action-btn {
            flex: 1;
            padding: 12px 24px;
            background: white;
            color: #1e3c72;
            border: 2px solid white;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .action-btn:hover {
            background: #f8f9fa;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .logo-upload {
            display: none;
        }

        .upload-logo-btn {
            padding: 8px 16px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .upload-logo-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .save-load-btn {
            padding: 10px 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid white;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .save-load-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 10000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 0;
            border-radius: 20px;
            width: 90%;
            max-width: 800px;
            max-height: 80vh;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            animation: slideDown 0.3s;
        }

        @keyframes slideDown {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-header h2 {
            margin: 0;
            font-size: 24px;
        }

        .close-modal {
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            background: none;
            border: none;
            color: white;
            transition: transform 0.2s;
        }

        .close-modal:hover {
            transform: scale(1.2);
        }

        .modal-body {
            padding: 30px;
            max-height: 60vh;
            overflow-y: auto;
        }

        .saved-calculation {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            border: 2px solid #e9ecef;
            transition: all 0.3s;
        }

        .saved-calculation:hover {
            border-color: #667eea;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
            transform: translateY(-2px);
        }

        .saved-calculation h3 {
            margin: 0 0 10px 0;
            color: #1e3c72;
            font-size: 18px;
        }

        .saved-calculation-info {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            font-size: 14px;
            color: #6c757d;
        }

        .saved-calculation-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .btn-load, .btn-delete {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }

        .btn-load {
            background: #667eea;
            color: white;
        }

        .btn-load:hover {
            background: #5568d3;
            transform: translateY(-2px);
        }

        .btn-delete {
            background: #dc3545;
            color: white;
        }

        .btn-delete:hover {
            background: #c82333;
            transform: translateY(-2px);
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #6c757d;
        }

        .empty-state-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        /* Scenario Comparison Styles */
        .scenario-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
        }

        .scenario-tab {
            padding: 12px 30px;
            background: white;
            border: 2px solid #667eea;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            color: #667eea;
        }

        .scenario-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .scenario-tab:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.2);
        }

        .scenario-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 30px;
        }

        .scenario-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .scenario-btn.save {
            background: #28a745;
            color: white;
        }

        .scenario-btn.compare {
            background: #667eea;
            color: white;
        }

        .scenario-btn.clear {
            background: #dc3545;
            color: white;
        }

        .scenario-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .comparison-container {
            background: white;
            padding: 30px;
            border-radius: 20px;
            margin-top: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .comparison-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .comparison-header h2 {
            color: #1e3c72;
            margin: 0 0 10px 0;
        }

        .winner-badge {
            display: inline-block;
            padding: 8px 16px;
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            color: white;
            border-radius: 20px;
            font-weight: 700;
            font-size: 14px;
            box-shadow: 0 4px 12px rgba(255, 215, 0, 0.4);
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 15px;
            text-align: center;
            border: 1px solid #dee2e6;
        }

        .comparison-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
        }

        .comparison-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .comparison-table .metric-name {
            text-align: left;
            font-weight: 600;
            color: #1e3c72;
        }

        .comparison-table .better {
            background: #d4edda;
            font-weight: 700;
            color: #155724;
        }

        .comparison-table .worse {
            background: #f8d7da;
            color: #721c24;
        }

        .scenario-info-box {
            background: #e7f3ff;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }

        .scenario-info-box h3 {
            margin: 0 0 10px 0;
            color: #1e3c72;
        }

        .scenario-info-box p {
            margin: 5px 0;
            color: #6c757d;
        }

        /* Theme Switcher */
        .theme-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .theme-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            color: white;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 18px;
        }

        .theme-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .theme-btn.active {
            background: white;
            color: #667eea;
        }

        .color-picker-container {
            position: relative;
        }

        .color-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .color-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .color-picker-menu {
            display: none;
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 10px;
            background: white;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            z-index: 1000;
        }

        .color-picker-menu.active {
            display: block;
        }

        .color-option {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            margin: 5px;
            display: inline-block;
            border: 3px solid transparent;
            transition: all 0.3s;
        }

        .color-option:hover {
            transform: scale(1.2);
            border-color: #667eea;
        }

        .color-option.active {
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        }

        /* Smart Recommendations */
        .recommendations-section {
            grid-column: 1 / -1;
            margin-top: 30px;
        }

        .recommendations-container {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(240, 147, 251, 0.3);
        }

        .recommendations-header {
            text-align: center;
            color: white;
            margin-bottom: 25px;
        }

        .recommendations-header h2 {
            margin: 0 0 10px 0;
            font-size: 28px;
        }

        .recommendations-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .recommendation-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s;
        }

        .recommendation-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .recommendation-card.positive {
            border-left: 5px solid #28a745;
        }

        .recommendation-card.warning {
            border-left: 5px solid #ffc107;
        }

        .recommendation-card.critical {
            border-left: 5px solid #dc3545;
        }

        .recommendation-icon {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .recommendation-title {
            font-size: 18px;
            font-weight: 700;
            color: #1e3c72;
            margin-bottom: 10px;
        }

        .recommendation-desc {
            color: #6c757d;
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .recommendation-impact {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 8px;
            font-weight: 600;
        }

        .recommendation-impact.positive {
            color: #28a745;
        }

        .recommendation-impact.negative {
            color: #dc3545;
        }

        .ai-score {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px;
        }

        .ai-score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: white;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .ai-score-value {
            font-size: 36px;
            font-weight: 700;
            line-height: 1;
        }

        .ai-score-label {
            font-size: 12px;
            color: #6c757d;
            margin-top: 5px;
        }

        /* Chart Styles */
        .charts-section {
            grid-column: 1 / -1;
            margin-top: 30px;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin-top: 20px;
        }

        .chart-container {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            border: 2px solid #e9ecef;
        }

        .chart-container h3 {
            color: #1e3c72;
            margin-bottom: 20px;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .chart-wrapper {
            position: relative;
            height: 300px;
        }

        .chart-wrapper canvas {
            max-height: 300px;
        }

        .content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
        }

        .section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #e9ecef;
        }

        .section h2 {
            color: #1e3c72;
            font-size: 20px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid #667eea;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            color: #495057;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group input[readonly] {
            background-color: #e9ecef !important;
            cursor: not-allowed;
            color: #495057;
            font-weight: 600;
        }

        .info-icon {
            display: inline-block;
            width: 18px;
            height: 18px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            text-align: center;
            line-height: 18px;
            font-size: 12px;
            font-weight: bold;
            cursor: help;
            margin-left: 8px;
            position: relative;
        }

        .info-icon:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            left: 25px;
            top: -10px;
            background: #2d3748;
            color: white;
            padding: 12px 15px;
            border-radius: 8px;
            white-space: normal;
            width: 280px;
            font-size: 13px;
            font-weight: normal;
            line-height: 1.5;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .info-icon:hover::before {
            content: '';
            position: absolute;
            left: 20px;
            top: 4px;
            border: 6px solid transparent;
            border-right-color: #2d3748;
            z-index: 1001;
        }

        .manager-report-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            margin-top: 15px;
            display: none;
        }

        .manager-report-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(245, 87, 108, 0.3);
        }

        .export-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
            flex: 1;
            max-width: 300px;
        }

        .excel-btn {
            background: linear-gradient(135deg, #1d6f42 0%, #26a65b 100%);
        }

        .excel-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(38, 166, 91, 0.3);
        }

        .pdf-btn {
            background: linear-gradient(135deg, #c0392b 0%, #e74c3c 100%);
        }

        .pdf-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(231, 76, 60, 0.3);
        }

        .manager-report {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px;
            border-radius: 20px;
            color: white;
            margin-top: 30px;
            display: none;
        }

        .manager-report h2 {
            font-size: 28px;
            margin-bottom: 30px;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }

        .manager-report-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .manager-report-card {
            background: rgba(255,255,255,0.95);
            padding: 20px;
            border-radius: 12px;
            color: #1e3c72;
        }

        .manager-report-card h4 {
            font-size: 13px;
            color: #6c757d;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .manager-report-card .value {
            font-size: 24px;
            font-weight: 700;
            color: #1e3c72;
        }

        .manager-summary {
            background: rgba(255,255,255,0.95);
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 25px;
            color: #1e3c72;
        }

        .manager-summary h3 {
            font-size: 18px;
            margin-bottom: 15px;
            color: #667eea;
        }

        .manager-summary p {
            margin: 8px 0;
            line-height: 1.6;
        }

        .highlight {
            font-weight: 700;
            color: #667eea;
        }

            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid #667eea;
        }

        .staff-category h4 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 16px;
        }

        .staff-total-display {
            background: linear-gradient(135deg, #f0f4ff 0%, #e8f0fe 100%);
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border: 2px solid #667eea;
        }

        .staff-total-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 10px;
        }

        .staff-total-label {
            font-weight: 600;
            color: #495057;
        }

        .staff-total-value {
            font-weight: 700;
            font-size: 18px;
            color: #1e3c72;
            text-align: right;
        }

        .staff-total-value.final {
            color: #28a745;
            font-size: 20px;
        }

        .time-slot {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
            align-items: center;
        }

        .time-slot label {
            font-weight: 600;
            color: #495057;
        }

        .time-slot input {
            padding: 8px;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            font-size: 13px;
        }

        .calculate-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            margin-top: 20px;
        }

        .calculate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .results {
            grid-column: 1 / -1;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            padding: 30px;
            border-radius: 15px;
            border: 3px solid #667eea;
        }

        .results h2 {
            color: #1e3c72;
            font-size: 24px;
            margin-bottom: 25px;
            text-align: center;
        }

        .result-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .result-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            border-left: 4px solid #667eea;
        }

        .result-card h3 {
            font-size: 14px;
            color: #6c757d;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .result-card .value {
            font-size: 28px;
            font-weight: 700;
            color: #1e3c72;
        }

        .result-card.positive {
            border-left-color: #28a745;
        }

        .result-card.positive .value {
            color: #28a745;
        }

        .result-card.negative {
            border-left-color: #dc3545;
        }

        .result-card.negative .value {
            color: #dc3545;
        }

        .result-card.warning {
            border-left-color: #ffc107;
        }

        .result-card.warning .value {
            color: #ffc107;
        }

        .result-card-large {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
            border-left: 6px solid #667eea;
            grid-column: span 1;
        }

        .result-card-large h3 {
            font-size: 18px;
            color: #6c757d;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .result-card-large .value {
            font-size: 42px;
            font-weight: 800;
            color: #1e3c72;
        }

        .result-card-large.rent-card {
            border-left-color: #dc3545;
        }

        .result-card-large.rent-card .value {
            color: #dc3545;
        }

        .result-card-large.profit-card.positive {
            border-left-color: #28a745;
        }

        .result-card-large.profit-card.positive .value {
            color: #28a745;
        }

        .result-card-large.profit-card.negative {
            border-left-color: #dc3545;
        }

        .result-card-large.profit-card.negative .value {
            color: #dc3545;
        }

        .result-card-large .small-text {
            font-size: 14px;
            color: #6c757d;
            margin-top: 10px;
            font-weight: 500;
        }

        .comparison-section {
            grid-column: 1 / -1;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-top: 30px;
            padding-top: 30px;
            border-top: 3px solid #667eea;
        }

        .period-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .period-tab {
            flex: 1;
            padding: 12px;
            background: white;
            border: 2px solid #dee2e6;
            border-radius: 8px;
            cursor: pointer;
            text-align: center;
            font-weight: 600;
            transition: all 0.3s;
        }

        .period-tab.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .small-text {
            font-size: 12px;
            color: #6c757d;
            margin-top: 5px;
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .container {
                border-radius: 10px;
            }

            .header {
                padding: 20px 15px;
            }

            .header h1 {
                font-size: 20px;
            }

            .header p {
                font-size: 12px;
            }

            .theme-controls {
                position: static;
                margin-top: 15px;
                justify-content: center;
            }

            .scenario-tabs {
                flex-direction: column;
            }

            .scenario-tab {
                width: 100%;
                padding: 10px;
            }

            .scenario-actions {
                flex-direction: column;
            }

            .scenario-btn {
                width: 100%;
            }

            .save-load-btn {
                font-size: 12px;
                padding: 8px 15px;
            }

            .content {
                grid-template-columns: 1fr;
                padding: 15px;
                gap: 20px;
            }

            .section {
                padding: 20px;
            }

            .section h2 {
                font-size: 18px;
            }

            .form-group label {
                font-size: 13px;
            }

            .form-group input,
            .form-group select {
                font-size: 14px;
            }

            .time-slot {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .time-slot input {
                font-size: 14px;
            }

            .calculate-btn {
                padding: 12px;
                font-size: 14px;
            }

            .result-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }

            .result-card {
                padding: 15px;
            }

            .result-card h3 {
                font-size: 14px;
            }

            .result-card .value {
                font-size: 24px;
            }

            .result-card-large .value {
                font-size: 28px;
            }

            .charts-grid {
                grid-template-columns: 1fr;
            }

            .chart-container {
                padding: 15px;
            }

            .chart-wrapper {
                height: 250px;
            }

            .action-buttons {
                flex-direction: column;
            }

            .action-btn {
                width: 100%;
            }

            .recommendations-grid {
                grid-template-columns: 1fr;
            }

            .recommendation-card {
                padding: 15px;
            }

            .comparison-table {
                font-size: 12px;
            }

            .comparison-table th,
            .comparison-table td {
                padding: 8px 5px;
            }

            .modal-content {
                width: 95%;
                margin: 10% auto;
            }

            .modal-body {
                padding: 20px;
            }

            .manager-report-grid {
                grid-template-columns: 1fr;
            }

            .logo-container {
                flex-direction: column;
                gap: 10px;
            }

            .logo-container img {
                max-height: 60px;
            }

            #exportButtons {
                flex-direction: column;
            }
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                box-shadow: none;
                max-width: 100%;
            }

            .header {
                background: #1e3c72 !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                page-break-after: avoid;
            }

            .logo-container {
                page-break-inside: avoid;
            }

            .section {
                page-break-inside: avoid;
                margin-bottom: 20px;
            }

            .results {
                page-break-before: always;
            }

            .calculate-btn, .action-buttons, .upload-logo-btn {
                display: none !important;
            }

            .result-card {
                page-break-inside: avoid;
            }

            .form-group input, .form-group select, .time-slot input {
                border: 1px solid #dee2e6;
                background: white;
            }

            @page {
                margin: 1cm;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <!-- Tema Kontrolleri -->
            <div class="theme-controls">
                <button class="theme-btn active" id="lightThemeBtn" onclick="setTheme('light')" title="Aydƒ±nlƒ±k Tema">
                    ‚òÄÔ∏è
                </button>
                <button class="theme-btn" id="darkThemeBtn" onclick="setTheme('dark')" title="Karanlƒ±k Tema">
                    üåô
                </button>
                <div class="color-picker-container">
                    <button class="color-btn" onclick="toggleColorPicker()">
                        üé® <span data-i18n="color">Renk</span>
                    </button>
                    <div class="color-picker-menu" id="colorPickerMenu">
                        <div style="margin-bottom: 10px; font-weight: 600; color: #1e3c72;" data-i18n="selectColor">Tema Rengi Se√ß:</div>
                        <div class="color-option active" style="background: linear-gradient(135deg, #667eea, #764ba2);" onclick="setColor('#667eea', '#764ba2')" data-primary="#667eea" data-secondary="#764ba2"></div>
                        <div class="color-option" style="background: linear-gradient(135deg, #f093fb, #f5576c);" onclick="setColor('#f093fb', '#f5576c')" data-primary="#f093fb" data-secondary="#f5576c"></div>
                        <div class="color-option" style="background: linear-gradient(135deg, #4facfe, #00f2fe);" onclick="setColor('#4facfe', '#00f2fe')" data-primary="#4facfe" data-secondary="#00f2fe"></div>
                        <div class="color-option" style="background: linear-gradient(135deg, #43e97b, #38f9d7);" onclick="setColor('#43e97b', '#38f9d7')" data-primary="#43e97b" data-secondary="#38f9d7"></div>
                        <div class="color-option" style="background: linear-gradient(135deg, #fa709a, #fee140);" onclick="setColor('#fa709a', '#fee140')" data-primary="#fa709a" data-secondary="#fee140"></div>
                        <div class="color-option" style="background: linear-gradient(135deg, #30cfd0, #330867);" onclick="setColor('#30cfd0', '#330867')" data-primary="#30cfd0" data-secondary="#330867"></div>
                    </div>
                </div>
                <select id="languageSelector" onchange="changeLanguage(this.value)" style="padding: 8px 12px; border-radius: 8px; border: 2px solid white; background: rgba(255,255,255,0.2); color: white; cursor: pointer; font-weight: 600;">
                    <option value="tr">üáπüá∑ TR</option>
                    <option value="en">üá¨üáß EN</option>
                </select>
            </div>

            <div class="logo-container">
                <img id="companyLogo" src="" alt="Logo" style="display: none;">
                <div>
                    <h1>üÖøÔ∏è <span data-i18n="title">PARKEXPERT Fƒ∞Zƒ∞Bƒ∞Lƒ∞TE HESAPLAMA</span></h1>
                    <p data-i18n="subtitle">Otopark Lokasyonu Karlƒ±lƒ±k Analizi</p>
                </div>
            </div>
            <input type="file" id="logoUpload" class="logo-upload" accept="image/*">
            <button class="upload-logo-btn" onclick="document.getElementById('logoUpload').click()">
                üì∏ <span data-i18n="uploadLogo">Logo Y√ºkle</span>
            </button>
            
            <!-- Kaydet/Y√ºkle Butonlarƒ± -->
            <div style="display: flex; gap: 10px; margin-top: 15px; justify-content: center;">
                <button class="save-load-btn" onclick="saveCalculation()">
                    üíæ Hesaplamayƒ± Kaydet
                </button>
                <button class="save-load-btn" onclick="showLoadModal()">
                    üìÇ Kayƒ±tlƒ± Hesaplamalar
                </button>
            </div>

            <!-- Senaryo Kar≈üƒ±la≈ütƒ±rma -->
            <div style="margin-top: 25px; padding-top: 20px; border-top: 2px solid rgba(255,255,255,0.2);">
                <div class="scenario-tabs">
                    <div class="scenario-tab active" onclick="switchScenario('A')" id="tabA">
                        üìä <span data-i18n="scenarioA">Senaryo A</span>
                    </div>
                    <div class="scenario-tab" onclick="switchScenario('B')" id="tabB">
                        üìä <span data-i18n="scenarioB">Senaryo B</span>
                    </div>
                </div>
                <div class="scenario-actions">
                    <button class="scenario-btn save" onclick="saveCurrentScenario()">
                        üíæ <span data-i18n="saveScenario">Bu Senaryoyu Kaydet</span>
                    </button>
                    <button class="scenario-btn compare" onclick="compareScenarios()">
                        ‚öñÔ∏è <span data-i18n="compareScenarios">Senaryolarƒ± Kar≈üƒ±la≈ütƒ±r</span>
                    </button>
                    <button class="scenario-btn clear" onclick="clearScenario()">
                        üóëÔ∏è <span data-i18n="clearScenario">Senaryoyu Temizle</span>
                    </button>
                </div>
                <div id="scenarioIndicator" style="text-align: center; margin-top: 10px; color: white; font-weight: 600;">
                    üìä <span data-i18n="activeScenario">Aktif: Senaryo</span> A
                </div>
            </div>
        </div>

        <div class="content">
            <!-- Genel Bilgiler -->
            <div class="section">
                <h2>üìä Genel Bilgiler</h2>
                <div class="form-group">
                    <label>Lokasyon Adƒ± <span class="info-icon" data-tooltip="Otopark lokasyonunun adƒ±. √ñrnek: Olivium AVM, Zorlu Center, Metropol ƒ∞stanbul vb.">i</span></label>
                    <input type="text" id="locationName" placeholder="√ñrn: Olivium AVM">
                </div>
                <div class="form-group">
                    <label>Devinim <span class="info-icon" data-tooltip="Bir park yerinin g√ºnde ka√ß kez kullanƒ±ldƒ±ƒüƒ±nƒ± g√∂steren oran. √ñrnek: 1.5 = Her park yeri g√ºnde ortalama 1.5 kez kullanƒ±lƒ±yor. Y√ºksek devinim = Daha fazla kazan√ß.">i</span></label>
                    <input type="number" id="devinim" value="1.5" min="0" step="0.1">
                </div>
                <div class="form-group">
                    <label>√áalƒ±≈üƒ±lan Ay (Yƒ±llƒ±k) <span class="info-icon" data-tooltip="Yƒ±l i√ßinde ka√ß ay otopark √ßalƒ±≈üacak. Genellikle 12 ay (t√ºm yƒ±l) se√ßilir. Mevsimlik otoparklar i√ßin daha az olabilir.">i</span></label>
                    <input type="number" id="workingMonths" value="12" min="1" max="12">
                </div>
            </div>

            <!-- Operasyonel Giderler -->
            <div class="section">
                <h2>üë• PERSONEL</h2>
                
                <div class="form-group">
                    <label>Asgari √úcretli Personel Sayƒ±sƒ± <span class="info-icon" data-tooltip="Asgari √ºcretle √ßalƒ±≈üan personel sayƒ±sƒ±. ƒ∞≈üverene toplam maliyet KDV ve katsayƒ± dahil otomatik hesaplanƒ±r.">i</span></label>
                    <input type="number" id="staffMinWage" value="2" min="0" onchange="calculateTotalStaffCost()" onkeyup="calculateTotalStaffCost()">
                </div>
                
                <div class="form-group">
                    <label>25.000‚Ç∫ √úcretli Personel Sayƒ±sƒ± <span class="info-icon" data-tooltip="25.000‚Ç∫ maa≈üla √ßalƒ±≈üan personel sayƒ±sƒ±. ƒ∞≈üverene toplam maliyet KDV ve katsayƒ± dahil otomatik hesaplanƒ±r.">i</span></label>
                    <input type="number" id="staff25k" value="0" min="0" onchange="calculateTotalStaffCost()" onkeyup="calculateTotalStaffCost()">
                </div>
                
                <div class="form-group">
                    <label>Y√∂netici Sayƒ±sƒ± <span class="info-icon" data-tooltip="Y√∂netici kadrosunda √ßalƒ±≈üan personel sayƒ±sƒ±. ƒ∞≈üverene toplam maliyet KDV ve katsayƒ± dahil otomatik hesaplanƒ±r.">i</span></label>
                    <input type="number" id="staffManager" value="0" min="0" onchange="calculateTotalStaffCost()" onkeyup="calculateTotalStaffCost()">
                </div>

                <!-- Toggle Butonu -->
                <button type="button" onclick="toggleStaffDetails()" style="width: 100%; padding: 10px; margin: 20px 0 10px 0; background: #f8f9fa; border: 2px solid #dee2e6; border-radius: 8px; cursor: pointer; font-weight: 600; color: #495057; transition: all 0.3s;">
                    üìã Maliyet Detaylarƒ±nƒ± G√∂ster/Gizle
                </button>

                <!-- Detay B√∂l√ºm√º (Gizli) -->
                <div id="staffDetailsSection" style="display: none; margin-top: 15px; padding: 20px; background: #f8f9fa; border-radius: 10px; border: 2px solid #dee2e6;">
                    <h3 style="color: #495057; font-size: 15px; margin-bottom: 15px; text-align: center;">üí∞ PERSONEL MALƒ∞YET DETAYLARI</h3>
                    
                    <!-- Asgari √úcretli Detay -->
                    <div style="margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid #dee2e6;">
                        <h4 style="color: #6c757d; font-size: 13px; margin-bottom: 10px;">Asgari √úcretli Personel</h4>
                        <div class="form-group">
                            <label style="font-size: 12px;">ƒ∞≈üverene Maliyet</label>
                            <input type="text" id="staffMinWageCost" readonly value="39.486,68" 
                                   style="background-color: #fff; cursor: not-allowed; font-weight: 600; font-size: 13px;">
                        </div>
                        <div class="form-group">
                            <label style="font-size: 12px;">Katsayƒ±lƒ± (x1.1)</label>
                            <input type="text" id="staffMinWageCoef" readonly value="43.435,35" 
                                   style="background-color: #fff; cursor: not-allowed; font-weight: 600; font-size: 13px;">
                        </div>
                        <div class="form-group">
                            <label style="font-size: 12px;">KDV'li + Katsayƒ±lƒ± (x1.32)</label>
                            <input type="text" id="staffMinWageFinal" readonly value="52.122,42" 
                                   style="background-color: #e7f5e7; cursor: not-allowed; font-weight: 700; color: #28a745; font-size: 13px;">
                        </div>
                    </div>

                    <!-- 25k Detay -->
                    <div style="margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid #dee2e6;">
                        <h4 style="color: #6c757d; font-size: 13px; margin-bottom: 10px;">25.000‚Ç∫ √úcretli Personel</h4>
                        <div class="form-group">
                            <label style="font-size: 12px;">ƒ∞≈üverene Maliyet</label>
                            <input type="text" id="staff25kCost" readonly value="44.082,00" 
                                   style="background-color: #fff; cursor: not-allowed; font-weight: 600; font-size: 13px;">
                        </div>
                        <div class="form-group">
                            <label style="font-size: 12px;">Katsayƒ±lƒ± (x1.1)</label>
                            <input type="text" id="staff25kCoef" readonly value="48.490,20" 
                                   style="background-color: #fff; cursor: not-allowed; font-weight: 600; font-size: 13px;">
                        </div>
                        <div class="form-group">
                            <label style="font-size: 12px;">KDV'li + Katsayƒ±lƒ± (x1.32)</label>
                            <input type="text" id="staff25kFinal" readonly value="58.188,24" 
                                   style="background-color: #e7f5e7; cursor: not-allowed; font-weight: 700; color: #28a745; font-size: 13px;">
                        </div>
                    </div>

                    <!-- Y√∂netici Detay -->
                    <div>
                        <h4 style="color: #6c757d; font-size: 13px; margin-bottom: 10px;">Y√∂netici</h4>
                        <div class="form-group">
                            <label style="font-size: 12px;">ƒ∞≈üverene Maliyet</label>
                            <input type="text" id="staffManagerCost" readonly value="70.435,00" 
                                   style="background-color: #fff; cursor: not-allowed; font-weight: 600; font-size: 13px;">
                        </div>
                        <div class="form-group">
                            <label style="font-size: 12px;">Katsayƒ±lƒ± (x1.1)</label>
                            <input type="text" id="staffManagerCoef" readonly value="77.478,50" 
                                   style="background-color: #fff; cursor: not-allowed; font-weight: 600; font-size: 13px;">
                        </div>
                        <div class="form-group">
                            <label style="font-size: 12px;">KDV'li + Katsayƒ±lƒ± (x1.32)</label>
                            <input type="text" id="staffManagerFinal" readonly value="92.974,20" 
                                   style="background-color: #e7f5e7; cursor: not-allowed; font-weight: 700; color: #28a745; font-size: 13px;">
                        </div>
                    </div>
                </div>
                
                <div class="form-group" style="margin-top: 25px; padding-top: 20px; border-top: 3px solid #667eea;">
                    <label style="color: #667eea; font-size: 16px;">Toplam Personel Sayƒ±sƒ±</label>
                    <input type="text" id="staffCountTotal" readonly value="2" 
                           style="background-color: #f0f4ff; cursor: not-allowed; font-weight: 700; font-size: 18px; color: #1e3c72; border: 2px solid #667eea;">
                </div>
                <div class="form-group">
                    <label style="color: #28a745; font-size: 16px;">Toplam Aylƒ±k Personel Maliyeti (KDV'li + Katsayƒ±lƒ±)</label>
                    <input type="text" id="staffCostTotal" readonly value="104.244,84" 
                           style="background-color: #f0fff4; cursor: not-allowed; font-weight: 700; font-size: 18px; color: #28a745; border: 2px solid #28a745;">
                </div>
            </div>

            <!-- Maliyet ve Giderler -->
            <div class="section">
                <h2>üí∞ Maliyet ve Giderler</h2>
                <div class="form-group">
                    <label>Yatƒ±rƒ±m Maliyeti KDV'li (‚Ç∫) <span class="info-icon" data-tooltip="Otopark sisteminin kurulum maliyeti. Yazƒ±lƒ±m, donanƒ±m, montaj dahil toplam yatƒ±rƒ±m tutarƒ± (KDV dahil).">i</span></label>
                    <input type="text" id="investmentCost" value="1.074.165" 
                           onkeyup="formatNumberInput(this)" 
                           onblur="formatNumberInput(this)">
                </div>
                <div class="form-group">
                    <label>Amortisman S√ºresi (Ay) <span class="info-icon" data-tooltip="Yatƒ±rƒ±mƒ±n ka√ß ayda itfa edileceƒüi. √ñrnek: 36 ay = 3 yƒ±l. Bu s√ºrede yatƒ±rƒ±m maliyeti aylƒ±k gider olarak daƒüƒ±tƒ±lƒ±r.">i</span></label>
                    <input type="number" id="amortizationMonths" value="36" min="1" max="120">
                    <div class="small-text" style="margin-top: 5px; color: #6c757d;">Yatƒ±rƒ±mƒ±n ka√ß ayda itfa edileceƒüi</div>
                </div>
                <div class="form-group">
                    <label>Operasyonel Gider Oranƒ± (%) <span class="info-icon" data-tooltip="Hasƒ±lat √ºzerinden hesaplanan i≈ületme giderleri. Elektrik, su, bakƒ±m-onarƒ±m, temizlik vb. masraflar i√ßin ayrƒ±lan oran.">i</span></label>
                    <input type="number" id="operationalRate" value="10" min="0" max="100" step="0.1">
                </div>
                <div class="form-group">
                    <label>Kira Oranƒ± (%) <span class="info-icon" data-tooltip="ƒ∞≈ületmeye (AVM/Plaza) √∂denen kira oranƒ±. Hasƒ±lat √ºzerinden hesaplanƒ±r. √ñrnek: %35 = Hasƒ±latƒ±n %35'i i≈ületmeye √∂denir.">i</span></label>
                    <input type="number" id="rentRate" value="35" min="0" max="100" step="0.1">
                </div>
            </div>

            <!-- Abonelikler -->
            <div class="section">
                <h2>üë• ABONELƒ∞KLER</h2>
                
                <div class="form-group">
                    <label>Personel Abone Sayƒ±sƒ± <span class="info-icon" data-tooltip="ƒ∞≈ületmede √ßalƒ±≈üan personele √∂zel abonelik sayƒ±sƒ±. Genellikle indirimli fiyatla verilir.">i</span></label>
                    <input type="number" id="personelSubs" value="0" min="0">
                </div>
                <div class="form-group">
                    <label>Personel Abone Fiyatƒ± (Aylƒ±k) (‚Ç∫) <span class="info-icon" data-tooltip="Personel aboneliƒüi aylƒ±k √ºcreti. ƒ∞≈ületme personeline verilen √∂zel fiyat.">i</span></label>
                    <input type="number" id="personelPrice" value="0" min="0">
                </div>
                
                <div class="form-group">
                    <label>Dƒ±≈ü Abonelik Sayƒ±sƒ± <span class="info-icon" data-tooltip="ƒ∞≈ületme dƒ±≈üƒ±ndan (harici m√º≈üteriler) alƒ±nan aylƒ±k abonelik sayƒ±sƒ±. Normal fiyattan satƒ±lƒ±r.">i</span></label>
                    <input type="number" id="externalSubs" value="0" min="0">
                </div>
                <div class="form-group">
                    <label>Dƒ±≈ü Abonelik Fiyatƒ± (Aylƒ±k) (‚Ç∫) <span class="info-icon" data-tooltip="Harici m√º≈üterilere verilen aylƒ±k abonelik √ºcreti. Market fiyatƒ±dƒ±r.">i</span></label>
                    <input type="number" id="externalPrice" value="0" min="0">
                </div>
            </div>

            <!-- Hafta ƒ∞√ßi Tarifeleri -->
            <div class="section">
                <h2>üìÖ HAFTAƒ∞√áƒ∞ TARƒ∞FELERƒ∞</h2>

                <div class="form-group">
                    <label>Hafta ƒ∞√ßi Satƒ±labilir Kapasite <span class="info-icon" data-tooltip="Hafta i√ßi g√ºnlerde satƒ±labilir toplam ara√ß kapasitesi. Fiziksel kapasiteden rezerv ve abonelik alanlarƒ± d√º≈ü√ºld√ºkten sonra kalan sayƒ±.">i</span></label>
                    <input type="number" id="weekdayCapacity" value="1670" min="0" onchange="calculateWeekendCapacity()" onkeyup="calculateWeekendCapacity()">
                </div>
                <div class="form-group">
                    <label>√áalƒ±≈üƒ±lan G√ºn (Aylƒ±k) <span class="info-icon" data-tooltip="Bir ayda ka√ß g√ºn hafta i√ßi √ßalƒ±≈üƒ±ldƒ±ƒüƒ±. Genelde 22-23 g√ºn kullanƒ±lƒ±r (Pzt-Cum toplam).">i</span></label>
                    <input type="number" id="workingDays" value="22" min="1" max="31">
                </div>

                <div class="time-slot">
                    <label>Saat Dilimi</label>
                    <label>Tarife (‚Ç∫)</label>
                    <label>Kullanƒ±m %</label>
                    <label>Park/G√ºn</label>
                </div>
                <div class="time-slot">
                    <input type="text" id="wd_slot1_hours" value="0-3" placeholder="0-3">
                    <input type="number" id="wd_slot1_tariff" value="0" min="0">
                    <input type="number" id="wd_slot1_usage" value="90" min="0" max="100" step="0.01">
                    <input type="number" id="wd_slot1_parking" value="1503" min="0">
                </div>
                <div class="time-slot">
                    <input type="text" id="wd_slot2_hours" value="3-4" placeholder="3-4">
                    <input type="number" id="wd_slot2_tariff" value="150" min="0">
                    <input type="number" id="wd_slot2_usage" value="7" min="0" max="100" step="0.01">
                    <input type="number" id="wd_slot2_parking" value="117" min="0">
                </div>
                <div class="time-slot">
                    <input type="text" id="wd_slot3_hours" value="4-5" placeholder="4-5">
                    <input type="number" id="wd_slot3_tariff" value="175" min="0">
                    <input type="number" id="wd_slot3_usage" value="2.19" min="0" max="100" step="0.01">
                    <input type="number" id="wd_slot3_parking" value="37" min="0">
                </div>
                <div class="time-slot">
                    <input type="text" id="wd_slot4_hours" value="5-6" placeholder="5-6">
                    <input type="number" id="wd_slot4_tariff" value="200" min="0">
                    <input type="number" id="wd_slot4_usage" value="0.77" min="0" max="100" step="0.01">
                    <input type="number" id="wd_slot4_parking" value="13" min="0">
                </div>
                <div class="time-slot">
                    <input type="text" id="wd_slot5_hours" value="6-12" placeholder="6-12">
                    <input type="number" id="wd_slot5_tariff" value="250" min="0">
                    <input type="number" id="wd_slot5_usage" value="0.02" min="0" max="100" step="0.01">
                    <input type="number" id="wd_slot5_parking" value="0" min="0">
                </div>
                <div class="time-slot">
                    <input type="text" id="wd_slot6_hours" value="12-24" placeholder="12-24">
                    <input type="number" id="wd_slot6_tariff" value="500" min="0">
                    <input type="number" id="wd_slot6_usage" value="0.02" min="0" max="100" step="0.01">
                    <input type="number" id="wd_slot6_parking" value="0" min="0">
                </div>
            </div>

            <!-- Hafta Sonu Tarifeleri -->
            <div class="section">
                <h2>üìÖ HAFTASONU TARƒ∞FELERƒ∞</h2>
                
                <div class="form-group">
                    <label>Hafta Sonu Satƒ±labilir Kapasite <span class="info-icon" data-tooltip="Hafta sonu g√ºnlerde satƒ±labilir ara√ß kapasitesi. Otomatik olarak hafta i√ßi kapasitenin 1.5 katƒ± olarak hesaplanƒ±r.">i</span></label>
                    <input type="number" id="weekendCapacity" value="2505" min="0" readonly 
                           style="background-color: #f0f4ff; cursor: not-allowed; font-weight: 600; color: #667eea;">
                </div>
                <div class="form-group">
                    <label>√áalƒ±≈üƒ±lan G√ºn (Aylƒ±k) <span class="info-icon" data-tooltip="Bir ayda ka√ß g√ºn hafta sonu √ßalƒ±≈üƒ±ldƒ±ƒüƒ±. Genelde 8-9 g√ºn kullanƒ±lƒ±r (Cmt+Paz toplam).">i</span></label>
                    <input type="number" id="weekendDays" value="8" min="0" max="31">
                </div>

                <div class="time-slot">
                    <label>Saat Dilimi</label>
                    <label>Tarife (‚Ç∫)</label>
                    <label>Kullanƒ±m %</label>
                    <label>Park/G√ºn</label>
                </div>
                <div class="time-slot">
                    <input type="text" id="we_slot1_hours" value="0-3" placeholder="0-3">
                    <input type="number" id="we_slot1_tariff" value="0" min="0">
                    <input type="number" id="we_slot1_usage" value="85" min="0" max="100" step="0.01">
                    <input type="number" id="we_slot1_parking" value="1828" min="0">
                </div>
                <div class="time-slot">
                    <input type="text" id="we_slot2_hours" value="3-4" placeholder="3-4">
                    <input type="number" id="we_slot2_tariff" value="150" min="0">
                    <input type="number" id="we_slot2_usage" value="9" min="0" max="100" step="0.01">
                    <input type="number" id="we_slot2_parking" value="194" min="0">
                </div>
                <div class="time-slot">
                    <input type="text" id="we_slot3_hours" value="4-5" placeholder="4-5">
                    <input type="number" id="we_slot3_tariff" value="175" min="0">
                    <input type="number" id="we_slot3_usage" value="3" min="0" max="100" step="0.01">
                    <input type="number" id="we_slot3_parking" value="65" min="0">
                </div>
                <div class="time-slot">
                    <input type="text" id="we_slot4_hours" value="5-6" placeholder="5-6">
                    <input type="number" id="we_slot4_tariff" value="200" min="0">
                    <input type="number" id="we_slot4_usage" value="2" min="0" max="100" step="0.01">
                    <input type="number" id="we_slot4_parking" value="43" min="0">
                </div>
                <div class="time-slot">
                    <input type="text" id="we_slot5_hours" value="6-12" placeholder="6-12">
                    <input type="number" id="we_slot5_tariff" value="250" min="0">
                    <input type="number" id="we_slot5_usage" value="0.5" min="0" max="100" step="0.01">
                    <input type="number" id="we_slot5_parking" value="11" min="0">
                </div>
                <div class="time-slot">
                    <input type="text" id="we_slot6_hours" value="12-24" placeholder="12-24">
                    <input type="number" id="we_slot6_tariff" value="500" min="0">
                    <input type="number" id="we_slot6_usage" value="0.5" min="0" max="100" step="0.01">
                    <input type="number" id="we_slot6_parking" value="11" min="0">
                </div>
            </div>

            <!-- Hesapla Butonu -->
            <button class="calculate-btn" onclick="calculate()">üìä <span data-i18n="calculate">Fƒ∞Zƒ∞Bƒ∞Lƒ∞TE HESAPLA</span></button>

            <!-- Yazdƒ±r ve PDF Butonlarƒ± -->
            <div class="action-buttons">
                <button class="action-btn" onclick="printReport()">
                    üñ®Ô∏è Yazdƒ±r
                </button>
                <button class="action-btn" onclick="downloadPDF()">
                    üì• PDF ƒ∞ndir
                </button>
            </div>

            <!-- Y√∂netici Raporu Butonu -->
            <button class="manager-report-btn" id="managerReportBtn" onclick="generateManagerReport()">
                üìä Y√∂netici √ñzet Raporu Olu≈ütur
            </button>

            <!-- Export Butonlarƒ± -->
            <div id="exportButtons" style="display: none; margin-top: 15px; display: flex; gap: 15px; justify-content: center;">
                <button class="export-btn excel-btn" onclick="exportToExcel()">
                    üìä Excel'e Aktar
                </button>
                <button class="export-btn pdf-btn" onclick="exportToPDF()">
                    üìÑ PDF ƒ∞ndir (Grafiklerle)
                </button>
            </div>

            <!-- Senaryo Kar≈üƒ±la≈ütƒ±rma Sonu√ßlarƒ± -->
            <div class="comparison-container" id="comparisonResults" style="display: none; grid-column: 1 / -1;">
                <div class="comparison-header">
                    <h2>‚öñÔ∏è SENARYO KAR≈ûILA≈ûTIRMASI</h2>
                    <div id="winnerBadge"></div>
                </div>
                <div id="comparisonContent"></div>
            </div>

            <!-- Sonu√ßlar -->
            <div class="results" id="results" style="display: none;">
                <h2>üìà Fƒ∞Zƒ∞Bƒ∞Lƒ∞TE SONU√áLARI</h2>
                <div class="result-grid" id="resultGrid"></div>
            </div>

            <!-- Grafikler B√∂l√ºm√º -->
            <div class="charts-section" id="chartsSection" style="display: none;">
                <h2 style="text-align: center; color: #1e3c72; margin-bottom: 10px;">üìä GRAFƒ∞K ANALƒ∞ZLER</h2>
                <div class="charts-grid">
                    <div class="chart-container">
                        <h3>üìä Hafta ƒ∞√ßi vs Hafta Sonu Hasƒ±lat</h3>
                        <div class="chart-wrapper">
                            <canvas id="revenueComparisonChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-container">
                        <h3>ü•ß Gider Daƒüƒ±lƒ±mƒ±</h3>
                        <div class="chart-wrapper">
                            <canvas id="expenseDistributionChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-container">
                        <h3>üìà Aylƒ±k Gelir vs Gider</h3>
                        <div class="chart-wrapper">
                            <canvas id="incomeExpenseChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-container">
                        <h3>üí∞ 12 Aylƒ±k Kar/Zarar Projeksiyonu</h3>
                        <div class="chart-wrapper">
                            <canvas id="yearlyProjectionChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Akƒ±llƒ± √ñneriler -->
            <div class="recommendations-section" id="recommendationsSection" style="display: none;">
                <div class="recommendations-container">
                    <div class="recommendations-header">
                        <h2>ü§ñ AKILLI √ñNERƒ∞LER & ANALƒ∞Z</h2>
                        <p style="margin: 0; opacity: 0.9;">Yapay Zeka Destekli Kar Optimizasyonu</p>
                    </div>
                    <div class="ai-score">
                        <div class="ai-score-circle" id="profitabilityScore">
                            <div class="ai-score-value" id="scoreValue">-</div>
                            <div class="ai-score-label">Karlƒ±lƒ±k Skoru</div>
                        </div>
                    </div>
                    <div class="recommendations-grid" id="recommendationsGrid">
                        <!-- √ñneriler buraya gelecek -->
                    </div>
                </div>
            </div>

            <!-- Y√∂netici Raporu -->
            <div class="manager-report" id="managerReport">
                <h2>üìä Y√ñNETƒ∞Cƒ∞ √ñZET RAPORU</h2>
                <div id="managerReportContent"></div>
            </div>
        </div>
    </div>

    <script>
        // Binlik ayra√ß formatƒ±
        function formatNumberInput(input) {
            let value = input.value.replace(/\./g, '').replace(/,/g, '');
            if (value && !isNaN(value)) {
                input.value = parseInt(value).toLocaleString('tr-TR');
            }
        }


        // Personel detaylarƒ±nƒ± g√∂ster/gizle
        function toggleStaffDetails() {
            const detailsSection = document.getElementById('staffDetailsSection');
            if (detailsSection.style.display === 'none') {
                detailsSection.style.display = 'block';
            } else {
                detailsSection.style.display = 'none';
            }
        }

        // Hafta sonu kapasitesini otomatik hesapla
        function calculateWeekendCapacity() {
            const weekdayCapacity = parseFloat(document.getElementById('weekdayCapacity').value) || 0;
            const weekendCapacity = Math.round(weekdayCapacity * 1.5);
            document.getElementById('weekendCapacity').value = weekendCapacity;
        }

        // TEMA Y√ñNETƒ∞Mƒ∞ FONKSƒ∞YONLARI
        
        // √áeviri Veritabanƒ±
        const translations = {
            tr: {
                // Header
                title: "PARKEXPERT Fƒ∞Zƒ∞Bƒ∞Lƒ∞TE HESAPLAMA",
                subtitle: "Otopark Lokasyonu Karlƒ±lƒ±k Analizi",
                uploadLogo: "Logo Y√ºkle",
                saveCalculation: "Hesaplamayƒ± Kaydet",
                savedCalculations: "Kayƒ±tlƒ± Hesaplamalar",
                color: "Renk",
                selectColor: "Tema Rengi Se√ß:",
                
                // Scenarios
                scenarioA: "Senaryo A",
                scenarioB: "Senaryo B",
                saveScenario: "Bu Senaryoyu Kaydet",
                compareScenarios: "Senaryolarƒ± Kar≈üƒ±la≈ütƒ±r",
                clearScenario: "Senaryoyu Temizle",
                activeScenario: "Aktif: Senaryo",
                
                // Buttons
                calculate: "Fizibilite Hesapla",
                print: "Yazdƒ±r",
                downloadPDF: "PDF ƒ∞ndir",
                exportExcel: "Excel'e Aktar",
                exportPDFCharts: "PDF ƒ∞ndir (Grafiklerle)",
                generateReport: "Y√∂netici √ñzet Raporu Olu≈ütur",
                
                // Sections
                generalInfo: "Genel Bilgiler",
                personnel: "PERSONEL",
                costsExpenses: "Maliyet ve Giderler",
                subscriptions: "ABONELƒ∞KLER",
                weekdayRates: "HAFTAƒ∞√áƒ∞ TARƒ∞FELERƒ∞",
                weekendRates: "HAFTASONU TARƒ∞FELERƒ∞",
                results: "Fƒ∞Zƒ∞Bƒ∞Lƒ∞TE SONU√áLARI",
                charts: "GRAFƒ∞K ANALƒ∞ZLER",
                smartRecommendations: "AKILLI √ñNERƒ∞LER & ANALƒ∞Z",
                aiAnalysis: "Yapay Zeka Destekli Kar Optimizasyonu",
                profitabilityScore: "Karlƒ±lƒ±k Skoru",
                managerReport: "Y√ñNETƒ∞Cƒ∞ √ñZET RAPORU"
            },
            en: {
                // Header
                title: "PARKEXPERT FEASIBILITY CALCULATOR",
                subtitle: "Parking Location Profitability Analysis",
                uploadLogo: "Upload Logo",
                saveCalculation: "Save Calculation",
                savedCalculations: "Saved Calculations",
                color: "Color",
                selectColor: "Select Theme Color:",
                
                // Scenarios
                scenarioA: "Scenario A",
                scenarioB: "Scenario B",
                saveScenario: "Save This Scenario",
                compareScenarios: "Compare Scenarios",
                clearScenario: "Clear Scenario",
                activeScenario: "Active: Scenario",
                
                // Buttons
                calculate: "Calculate Feasibility",
                print: "Print",
                downloadPDF: "Download PDF",
                exportExcel: "Export to Excel",
                exportPDFCharts: "Download PDF (with Charts)",
                generateReport: "Generate Manager Summary",
                
                // Sections
                generalInfo: "General Information",
                personnel: "PERSONNEL",
                costsExpenses: "Costs and Expenses",
                subscriptions: "SUBSCRIPTIONS",
                weekdayRates: "WEEKDAY RATES",
                weekendRates: "WEEKEND RATES",
                results: "FEASIBILITY RESULTS",
                charts: "CHART ANALYSIS",
                smartRecommendations: "SMART RECOMMENDATIONS & ANALYSIS",
                aiAnalysis: "AI-Powered Profit Optimization",
                profitabilityScore: "Profitability Score",
                managerReport: "MANAGER SUMMARY REPORT"
            }
        };

        let currentLanguage = 'tr';

        function changeLanguage(lang) {
            currentLanguage = lang;
            localStorage.setItem('parkexpert-language', lang);
            
            // T√ºm data-i18n attribute'larƒ±nƒ± g√ºncelle
            document.querySelectorAll('[data-i18n]').forEach(element => {
                const key = element.getAttribute('data-i18n');
                if (translations[lang][key]) {
                    // Input placeholder'lar i√ßin
                    if (element.tagName === 'INPUT' && element.placeholder) {
                        element.placeholder = translations[lang][key];
                    } 
                    // Button ve text i√ßerikler i√ßin
                    else {
                        element.textContent = translations[lang][key];
                    }
                }
            });
            
            // Sayfa ba≈ülƒ±ƒüƒ±nƒ± g√ºncelle
            document.title = lang === 'tr' ? 
                'Parkexpert - Otopark Fizibilite Hesaplama' : 
                'Parkexpert - Parking Feasibility Calculator';
        }

        function setTheme(theme) {
            document.documentElement.setAttribute('data-theme', theme);
            localStorage.setItem('parkexpert-theme', theme);
            
            // Buton durumlarƒ±nƒ± g√ºncelle
            document.getElementById('lightThemeBtn').classList.toggle('active', theme === 'light');
            document.getElementById('darkThemeBtn').classList.toggle('active', theme === 'dark');
        }

        function setColor(primary, secondary) {
            document.documentElement.style.setProperty('--primary-color', primary);
            document.documentElement.style.setProperty('--secondary-color', secondary);
            
            // Rengi localStorage'a kaydet
            localStorage.setItem('parkexpert-primary-color', primary);
            localStorage.setItem('parkexpert-secondary-color', secondary);
            
            // Aktif renk se√ßeneƒüini i≈üaretle
            document.querySelectorAll('.color-option').forEach(option => {
                const isActive = option.getAttribute('data-primary') === primary;
                option.classList.toggle('active', isActive);
            });
            
            // Men√ºy√º kapat
            setTimeout(() => {
                document.getElementById('colorPickerMenu').classList.remove('active');
            }, 300);
        }

        function toggleColorPicker() {
            document.getElementById('colorPickerMenu').classList.toggle('active');
        }

        // Sayfa dƒ±≈üƒ±na tƒ±klayƒ±nca renk se√ßiciyi kapat
        document.addEventListener('click', function(e) {
            const colorPicker = document.querySelector('.color-picker-container');
            if (colorPicker && !colorPicker.contains(e.target)) {
                document.getElementById('colorPickerMenu').classList.remove('active');
            }
        });

        // Personel maliyeti otomatik hesaplama (kategori bazlƒ±)
        function calculateTotalStaffCost() {
            const minWageCount = parseFloat(document.getElementById('staffMinWage').value) || 0;
            const minWageCostFinal = 52122.42; // KDV'li + Katsayƒ±lƒ±
            
            const staff25kCount = parseFloat(document.getElementById('staff25k').value) || 0;
            const staff25kCostFinal = 58188.24; // KDV'li + Katsayƒ±lƒ±
            
            const managerCount = parseFloat(document.getElementById('staffManager').value) || 0;
            const managerCostFinal = 92974.20; // KDV'li + Katsayƒ±lƒ±
            
            const totalCount = minWageCount + staff25kCount + managerCount;
            const totalCost = (minWageCount * minWageCostFinal) + (staff25kCount * staff25kCostFinal) + (managerCount * managerCostFinal);
            
            const totalCostFormatted = totalCost.toLocaleString('tr-TR', {minimumFractionDigits: 2, maximumFractionDigits: 2});
            
            document.getElementById('staffCountTotal').value = totalCount;
            document.getElementById('staffCostTotal').value = totalCostFormatted;
        }

        // Logo y√ºkleme
        document.getElementById('logoUpload').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const logoImg = document.getElementById('companyLogo');
                    logoImg.src = event.target.result;
                    logoImg.style.display = 'block';
                    // Logo'yu localStorage'a kaydet
                    localStorage.setItem('parkexpertLogo', event.target.result);
                };
                reader.readAsDataURL(file);
            }
        });

        // Sayfa y√ºklendiƒüinde logo'yu kontrol et
        window.addEventListener('load', function() {
            // Tema ve renk tercihlerini y√ºkle
            const savedTheme = localStorage.getItem('parkexpert-theme') || 'light';
            const savedPrimary = localStorage.getItem('parkexpert-primary-color');
            const savedSecondary = localStorage.getItem('parkexpert-secondary-color');
            const savedLanguage = localStorage.getItem('parkexpert-language') || 'tr';
            
            setTheme(savedTheme);
            
            if (savedPrimary && savedSecondary) {
                setColor(savedPrimary, savedSecondary);
            }
            
            // Dil tercihini y√ºkle
            document.getElementById('languageSelector').value = savedLanguage;
            changeLanguage(savedLanguage);
            
            // Logo kontrol
            const savedLogo = localStorage.getItem('parkexpertLogo');
            if (savedLogo) {
                const logoImg = document.getElementById('companyLogo');
                logoImg.src = savedLogo;
                logoImg.style.display = 'block';
            }
            
            // Personel maliyeti hesaplamasƒ±nƒ± ba≈ülat
            calculateTotalStaffCost();
            
            // Hafta sonu kapasitesini hesapla
            calculateWeekendCapacity();
            
            console.log('‚úÖ Parkexpert Fizibilite Aracƒ± hazƒ±r!');
        });

        function printReport() {
            // √ñnce hesaplama yapƒ±lmƒ±≈ü mƒ± kontrol et
            const resultsDiv = document.getElementById('results');
            if (resultsDiv.style.display === 'none') {
                alert('L√ºtfen √∂nce fizibilite hesaplamasƒ± yapƒ±n.');
                return;
            }
            window.print();
        }

        function downloadPDF() {
            // √ñnce hesaplama yapƒ±lmƒ±≈ü mƒ± kontrol et
            const resultsDiv = document.getElementById('results');
            if (resultsDiv.style.display === 'none') {
                alert('L√ºtfen √∂nce fizibilite hesaplamasƒ± yapƒ±n.');
                return;
            }
            
            // Kullanƒ±cƒ±ya PDF olarak kaydetme talimatƒ±
            alert('PDF indirmek i√ßin a√ßƒ±lacak yazdƒ±rma penceresinden "PDF olarak kaydet" se√ßeneƒüini se√ßin.');
            window.print();
        }

        function calculate() {
            // Genel Bilgiler
            const locationName = document.getElementById('locationName').value || 'Lokasyon';
            const weekdayCapacity = parseFloat(document.getElementById('weekdayCapacity').value) || 0;
            const weekendCapacity = parseFloat(document.getElementById('weekendCapacity').value) || 0;
            const devinim = parseFloat(document.getElementById('devinim').value) || 1;
            const workingDays = parseFloat(document.getElementById('workingDays').value) || 22;
            const workingMonths = parseFloat(document.getElementById('workingMonths').value) || 12;

            // Maliyetler - Yatƒ±rƒ±m maliyetini formatlanmƒ±≈ü halinden parse et
            const investmentCostValue = document.getElementById('investmentCost').value.replace(/\./g, '').replace(/,/g, '.');
            const investmentCost = parseFloat(investmentCostValue) || 0;
            
            const operationalRate = parseFloat(document.getElementById('operationalRate').value) || 10;
            const rentRate = parseFloat(document.getElementById('rentRate').value) || 35;
            
            // Personel maliyeti - Toplam deƒüerleri kullan
            const staffCount = parseFloat(document.getElementById('staffCountTotal').value) || 0;
            const staffCostTotalValue = document.getElementById('staffCostTotal').value.replace(/\./g, '').replace(/,/g, '.');
            const monthlyStaffCost = parseFloat(staffCostTotalValue) || 0;

            // Abonelik Hesaplamalarƒ± (Sadece Personel ve Dƒ±≈ü)
            const personelSubs = parseFloat(document.getElementById('personelSubs').value) || 0;
            const personelPrice = parseFloat(document.getElementById('personelPrice').value) || 0;
            const externalSubs = parseFloat(document.getElementById('externalSubs').value) || 0;
            const externalPrice = parseFloat(document.getElementById('externalPrice').value) || 0;

            const monthlySubRevenue = (personelSubs * personelPrice) + (externalSubs * externalPrice);

            // Hafta ƒ∞√ßi Saat Dilimi Hesaplamalarƒ±
            let weekdayDailyRevenue = 0;
            for (let i = 1; i <= 6; i++) {
                const tariff = parseFloat(document.getElementById(`wd_slot${i}_tariff`).value) || 0;
                const parking = parseFloat(document.getElementById(`wd_slot${i}_parking`).value) || 0;
                weekdayDailyRevenue += tariff * parking;
            }

            // Hafta Sonu Hesaplamalarƒ±
            const weekendDays = parseFloat(document.getElementById('weekendDays').value) || 8;

            // Hafta Sonu Saat Dilimi Hesaplamalarƒ±
            let weekendDailyRevenue = 0;
            for (let i = 1; i <= 6; i++) {
                const tariff = parseFloat(document.getElementById(`we_slot${i}_tariff`).value) || 0;
                const parking = parseFloat(document.getElementById(`we_slot${i}_parking`).value) || 0;
                weekendDailyRevenue += tariff * parking;
            }

            // G√ºnl√ºk ve Aylƒ±k Toplam Hesaplamalarƒ±
            const dailyTotalRevenue = weekdayDailyRevenue + weekendDailyRevenue;
            
            const weekdayMonthlyRevenue = (weekdayDailyRevenue * workingDays);
            const weekdayYearlyRevenue = weekdayMonthlyRevenue * workingMonths;

            const weekendMonthlyRevenue = (weekendDailyRevenue * weekendDays);
            const weekendYearlyRevenue = weekendMonthlyRevenue * workingMonths;

            const totalMonthlyRevenue = weekdayMonthlyRevenue + weekendMonthlyRevenue + monthlySubRevenue;
            const totalYearlyRevenue = totalMonthlyRevenue * workingMonths;

            // Amortisman hesaplamasƒ±
            const amortizationMonths = parseFloat(document.getElementById('amortizationMonths').value) || 36;
            const monthlyAmortization = investmentCost / amortizationMonths;
            const amortizationPercentage = totalMonthlyRevenue > 0 ? (monthlyAmortization / totalMonthlyRevenue) * 100 : 0;

            // Gider Hesaplamalarƒ±
            // monthlyStaffCost zaten toplam maliyet (kategorilerin toplamƒ±)
            const yearlyStaffCost = monthlyStaffCost * 12;
            const staffCostPercentage = (monthlyStaffCost / totalMonthlyRevenue) * 100;

            const monthlyOperationalCost = (totalMonthlyRevenue * operationalRate) / 100;
            const yearlyOperationalCost = monthlyOperationalCost * 12;

            const monthlyRent = (totalMonthlyRevenue * rentRate) / 100;
            const yearlyRent = monthlyRent * 12;

            const totalMonthlyExpenses = monthlyStaffCost + monthlyOperationalCost + monthlyRent;
            const totalYearlyExpenses = yearlyStaffCost + yearlyOperationalCost + yearlyRent;
            const totalExpensesPercentage = (totalMonthlyExpenses / totalMonthlyRevenue) * 100;

            // Net Kar/Zarar
            const monthlyNetProfit = totalMonthlyRevenue - totalMonthlyExpenses;
            const yearlyNetProfit = totalYearlyRevenue - totalYearlyExpenses;
            const netProfitPercentage = (monthlyNetProfit / totalMonthlyRevenue) * 100;

            // Yatƒ±rƒ±m Geri D√∂n√º≈ü S√ºresi (Ay)
            const paybackPeriod = monthlyNetProfit > 0 ? investmentCost / monthlyNetProfit : 0;

            // Sonu√ßlarƒ± G√∂ster
            const resultsDiv = document.getElementById('results');
            const resultGrid = document.getElementById('resultGrid');
            
            resultsDiv.style.display = 'block';
            
            const profitClass = monthlyNetProfit > 0 ? 'positive' : 'negative';
            const yearlyProfitClass = yearlyNetProfit > 0 ? 'positive' : 'negative';

            resultGrid.innerHTML = `
                <div class="result-card">
                    <h3>Hafta ƒ∞√ßi G√ºnl√ºk Hasƒ±lat</h3>
                    <div class="value">${formatCurrency(weekdayDailyRevenue)}</div>
                    <div class="small-text">Hafta ƒ∞√ßi Aylƒ±k: ${formatCurrency(weekdayMonthlyRevenue)}</div>
                </div>
                <div class="result-card">
                    <h3>Hafta Sonu G√ºnl√ºk Hasƒ±lat</h3>
                    <div class="value">${formatCurrency(weekendDailyRevenue)}</div>
                    <div class="small-text">Hafta Sonu Aylƒ±k: ${formatCurrency(weekendMonthlyRevenue)}</div>
                </div>
                <div class="result-card warning">
                    <h3>G√ºnl√ºk Toplam Hasƒ±lat</h3>
                    <div class="value">${formatCurrency(dailyTotalRevenue)}</div>
                    <div class="small-text">Aylƒ±k Toplam: ${formatCurrency(weekdayMonthlyRevenue + weekendMonthlyRevenue)}</div>
                </div>
                <div class="result-card">
                    <h3>Abonelik Hasƒ±latƒ±</h3>
                    <div class="value">${formatCurrency(monthlySubRevenue)}</div>
                    <div class="small-text">Personel + Dƒ±≈ü Abonelik</div>
                </div>
                <div class="result-card warning">
                    <h3>Aylƒ±k Toplam Hasƒ±lat</h3>
                    <div class="value">${formatCurrency(totalMonthlyRevenue)}</div>
                    <div class="small-text">Yƒ±llƒ±k: ${formatCurrency(totalYearlyRevenue)}</div>
                </div>
                <div class="result-card">
                    <h3>Aylƒ±k Personel Maliyeti</h3>
                    <div class="value">${formatCurrency(monthlyStaffCost)}</div>
                    <div class="small-text">${staffCount} Personel (ƒ∞≈üverene Toplam) ‚Ä¢ %${staffCostPercentage.toFixed(1)} Oran</div>
                </div>
                <div class="result-card">
                    <h3>Aylƒ±k Operasyonel Gider</h3>
                    <div class="value">${formatCurrency(monthlyOperationalCost)}</div>
                    <div class="small-text">%${operationalRate} Oranƒ±nda</div>
                </div>
                <div class="result-card">
                    <h3>Aylƒ±k Toplam Gider</h3>
                    <div class="value">${formatCurrency(totalMonthlyExpenses)}</div>
                    <div class="small-text">%${totalExpensesPercentage.toFixed(1)} Oran ‚Ä¢ Yƒ±llƒ±k: ${formatCurrency(totalYearlyExpenses)}</div>
                </div>
                <div class="result-card ${paybackPeriod < 24 ? 'positive' : paybackPeriod < 48 ? 'warning' : 'negative'}">
                    <h3>Yatƒ±rƒ±m Geri D√∂n√º≈ü</h3>
                    <div class="value">${paybackPeriod > 0 ? paybackPeriod.toFixed(1) + ' ay' : 'Belirsiz'}</div>
                    <div class="small-text">${paybackPeriod > 0 ? (paybackPeriod/12).toFixed(1) + ' yƒ±l' : ''}</div>
                </div>
                <div class="result-card">
                    <h3>Yatƒ±rƒ±m Maliyeti</h3>
                    <div class="value">${formatCurrency(investmentCost)}</div>
                    <div class="small-text">KDV Dahil</div>
                </div>
                <div class="result-card">
                    <h3>Aylƒ±k Amortisman Payƒ±</h3>
                    <div class="value">${formatCurrency(monthlyAmortization)}</div>
                    <div class="small-text">${amortizationMonths} Ay ‚Ä¢ %${amortizationPercentage.toFixed(1)} Oran</div>
                </div>
                <div class="result-card">
                    <h3>Hafta ƒ∞√ßi Kapasite</h3>
                    <div class="value">${weekdayCapacity}</div>
                    <div class="small-text">Satƒ±labilir Park Yeri</div>
                </div>
                <div class="result-card">
                    <h3>Hafta Sonu Kapasite</h3>
                    <div class="value">${weekendCapacity}</div>
                    <div class="small-text">x1.5 Otomatik</div>
                </div>
                <div class="result-card">
                    <h3>Devinim</h3>
                    <div class="value">${devinim.toFixed(2)}</div>
                    <div class="small-text">Park D√∂n√º≈ü Oranƒ±</div>
                </div>
                <div class="result-card">
                    <h3>Toplam Abone</h3>
                    <div class="value">${personelSubs + externalSubs}</div>
                    <div class="small-text">Personel + Dƒ±≈ü Abonelik</div>
                </div>
                
                <div class="comparison-section">
                    <div class="result-card-large rent-card">
                        <h3>üè¢ ƒ∞≈ületmeye √ñdenen Kira</h3>
                        <div class="value">${formatCurrency(monthlyRent)}</div>
                        <div class="small-text">%${rentRate} Oranƒ± ‚Ä¢ Yƒ±llƒ±k: ${formatCurrency(yearlyRent)}</div>
                    </div>
                    <div class="result-card-large profit-card ${profitClass}">
                        <h3>üíº Bize Kalan Net Kar</h3>
                        <div class="value">${formatCurrency(monthlyNetProfit)}</div>
                        <div class="small-text">${monthlyNetProfit > 0 ? '‚úÖ Karlƒ±' : '‚ùå Zararlƒ±'} ‚Ä¢ %${Math.abs(netProfitPercentage).toFixed(1)} Oran ‚Ä¢ Yƒ±llƒ±k: ${formatCurrency(yearlyNetProfit)}</div>
                    </div>
                </div>
            `;

            // Y√∂netici raporu butonunu g√∂ster
            document.getElementById('managerReportBtn').style.display = 'block';
            
            // Export butonlarƒ±nƒ± g√∂ster
            document.getElementById('exportButtons').style.display = 'flex';
            
            // Grafikleri g√∂ster ve olu≈ütur
            document.getElementById('chartsSection').style.display = 'block';
            createCharts(weekdayDailyRevenue, weekdayMonthlyRevenue, weekendDailyRevenue, weekendMonthlyRevenue, 
                        monthlySubRevenue, totalMonthlyRevenue, monthlyStaffCost, monthlyOperationalCost, 
                        monthlyRent, totalMonthlyExpenses, monthlyNetProfit);

            // Akƒ±llƒ± √∂neriler olu≈ütur
            document.getElementById('recommendationsSection').style.display = 'block';
            generateSmartRecommendations({
                totalRevenue: totalMonthlyRevenue,
                totalExpenses: totalMonthlyExpenses,
                netProfit: monthlyNetProfit,
                staffCost: monthlyStaffCost,
                staffCount: staffCount,
                opCost: monthlyOperationalCost,
                rent: monthlyRent,
                weekdayCapacity: weekdayCapacity,
                weekendCapacity: weekendCapacity,
                devinim: devinim,
                rentRate: rentRate,
                operationalRate: operationalRate
            });

            // Scroll to results
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // AKILLI √ñNERƒ∞LER FONKSƒ∞YONU
        function generateSmartRecommendations(data) {
            const recommendations = [];
            
            // Karlƒ±lƒ±k skorunu hesapla (0-100)
            const profitMargin = (data.netProfit / data.totalRevenue) * 100;
            let profitabilityScore = 0;
            
            if (profitMargin > 30) profitabilityScore = 95;
            else if (profitMargin > 20) profitabilityScore = 85;
            else if (profitMargin > 15) profitabilityScore = 75;
            else if (profitMargin > 10) profitabilityScore = 65;
            else if (profitMargin > 5) profitabilityScore = 50;
            else if (profitMargin > 0) profitabilityScore = 35;
            else profitabilityScore = 15;
            
            // Skoru g√∂ster
            const scoreElement = document.getElementById('scoreValue');
            scoreElement.textContent = profitabilityScore;
            scoreElement.style.color = profitabilityScore >= 70 ? '#28a745' : profitabilityScore >= 50 ? '#ffc107' : '#dc3545';
            
            // 1. Personel Optimizasyonu
            const staffCostPercentage = (data.staffCost / data.totalRevenue) * 100;
            if (staffCostPercentage > 30) {
                const savings = data.staffCost * 0.1; // %10 azaltma
                const newProfit = data.netProfit + savings;
                const improvement = ((newProfit - data.netProfit) / data.netProfit * 100).toFixed(1);
                
                recommendations.push({
                    type: 'warning',
                    icon: 'üë•',
                    title: 'Personel Maliyeti Y√ºksek',
                    desc: `Personel maliyetiniz hasƒ±latƒ±n %${staffCostPercentage.toFixed(1)}'ini olu≈üturuyor. Sekt√∂r ortalamasƒ± %20-25 arasƒ±dƒ±r.`,
                    impact: `1 personeli azaltarak aylƒ±k ${formatCurrency(savings)} tasarruf edebilir, net karƒ± %${improvement} artƒ±rabilirsiniz.`,
                    impactType: 'positive'
                });
            } else if (staffCostPercentage < 15 && data.staffCount < 3) {
                recommendations.push({
                    type: 'positive',
                    icon: '‚úÖ',
                    title: 'Personel Maliyeti Optimal',
                    desc: `Personel maliyetiniz hasƒ±latƒ±n %${staffCostPercentage.toFixed(1)}'i ile ideal seviyede.`,
                    impact: 'Mevcut personel yapƒ±nƒ±zƒ± koruyun.',
                    impactType: 'positive'
                });
            }
            
            // 2. Kira Optimizasyonu
            const rentPercentage = (data.rent / data.totalRevenue) * 100;
            if (data.rentRate > 40) {
                const newRent = data.totalRevenue * 0.35;
                const savings = data.rent - newRent;
                const improvement = ((savings / data.netProfit) * 100).toFixed(1);
                
                recommendations.push({
                    type: 'critical',
                    icon: 'üè¢',
                    title: 'Kira Oranƒ± √áok Y√ºksek',
                    desc: `%${data.rentRate} kira oranƒ± s√ºrd√ºr√ºlebilir deƒüil. Sekt√∂r standardƒ± %30-35 arasƒ±dƒ±r.`,
                    impact: `Kira oranƒ±nƒ± %35'e d√º≈ü√ºrerek aylƒ±k ${formatCurrency(savings)} tasarruf edip net karƒ± %${improvement} artƒ±rabilirsiniz.`,
                    impactType: 'positive'
                });
            } else if (rentPercentage < 30) {
                recommendations.push({
                    type: 'positive',
                    icon: '‚ú®',
                    title: 'Kira Maliyeti M√ºkemmel',
                    desc: `%${data.rentRate} kira oranƒ± rekabet√ßi ve s√ºrd√ºr√ºlebilir.`,
                    impact: 'Mevcut anla≈ümanƒ±zƒ± korumaya devam edin.',
                    impactType: 'positive'
                });
            }
            
            // 3. Kapasite Kullanƒ±mƒ±
            if (data.devinim < 1.2) {
                const potentialRevenue = data.totalRevenue * 1.25;
                const improvement = potentialRevenue - data.totalRevenue;
                
                recommendations.push({
                    type: 'warning',
                    icon: 'üìä',
                    title: 'D√º≈ü√ºk Kapasite Kullanƒ±mƒ±',
                    desc: `Devinim oranƒ±nƒ±z ${data.devinim} ile d√º≈ü√ºk. Her park yeri g√ºnde daha fazla kullanƒ±lmalƒ±.`,
                    impact: `Devrinimi 1.5'e √ßƒ±kararak aylƒ±k ${formatCurrency(improvement)} ek gelir elde edebilirsiniz.`,
                    impactType: 'positive'
                });
            } else if (data.devinim > 1.8) {
                recommendations.push({
                    type: 'positive',
                    icon: 'üéØ',
                    title: 'Y√ºksek Kapasite Kullanƒ±mƒ±',
                    desc: `Devinim oranƒ±nƒ±z ${data.devinim} ile m√ºkemmel! Kapasiteyi verimli kullanƒ±yorsunuz.`,
                    impact: 'Kapasite geni≈ületme d√º≈ü√ºnebilirsiniz.',
                    impactType: 'positive'
                });
            }
            
            // 4. Karlƒ±lƒ±k Analizi
            if (data.netProfit < 0) {
                const breakeven = data.totalExpenses;
                const needed = breakeven - data.totalRevenue;
                
                recommendations.push({
                    type: 'critical',
                    icon: '‚ö†Ô∏è',
                    title: 'Zarar Durumu - Acil √ñnlem Gerekli',
                    desc: `Aylƒ±k ${formatCurrency(Math.abs(data.netProfit))} zarar ediyorsunuz. ƒ∞≈ületme s√ºrd√ºr√ºlebilir deƒüil.`,
                    impact: `Ba≈üa ba≈ü noktasƒ± i√ßin aylƒ±k ${formatCurrency(needed)} ek hasƒ±lat gerekiyor veya giderleri azaltƒ±n.`,
                    impactType: 'negative'
                });
            } else if (profitMargin > 25) {
                recommendations.push({
                    type: 'positive',
                    icon: 'üöÄ',
                    title: 'M√ºkemmel Karlƒ±lƒ±k',
                    desc: `%${profitMargin.toFixed(1)} kar marjƒ± ile sekt√∂r√ºn √ºzerinde performans g√∂steriyorsunuz.`,
                    impact: 'Yeni lokasyon yatƒ±rƒ±mlarƒ± deƒüerlendirin!',
                    impactType: 'positive'
                });
            }
            
            // 5. Operasyonel Verimlilik
            const opPercentage = (data.opCost / data.totalRevenue) * 100;
            if (opPercentage > 15) {
                const savings = data.opCost * 0.2;
                
                recommendations.push({
                    type: 'warning',
                    icon: '‚öôÔ∏è',
                    title: 'Operasyonel Giderler Y√ºksek',
                    desc: `%${data.operationalRate} operasyonel gider oranƒ± y√ºksek. Optimizasyon fƒ±rsatlarƒ± var.`,
                    impact: `Enerji tasarrufu ve bakƒ±m optimizasyonu ile aylƒ±k ${formatCurrency(savings)} tasarruf potansiyeli.`,
                    impactType: 'positive'
                });
            }
            
            // 6. Hafta Sonu Potansiyeli
            const weekendPotential = data.weekendCapacity * 1.1; // %10 artƒ±≈ü
            if (data.weekendCapacity > data.weekdayCapacity * 1.3) {
                recommendations.push({
                    type: 'positive',
                    icon: 'üìÖ',
                    title: 'Hafta Sonu Avantajƒ±',
                    desc: `Hafta sonu kapasitesi y√ºksek! Bu b√ºy√ºk bir fƒ±rsat.`,
                    impact: 'Hafta sonu √∂zel tarifeleri ve kampanyalarƒ± deƒüerlendirin.',
                    impactType: 'positive'
                });
            }
            
            // √ñnerileri ekle
            const grid = document.getElementById('recommendationsGrid');
            grid.innerHTML = recommendations.map(rec => `
                <div class="recommendation-card ${rec.type}">
                    <div class="recommendation-icon">${rec.icon}</div>
                    <div class="recommendation-title">${rec.title}</div>
                    <div class="recommendation-desc">${rec.desc}</div>
                    <div class="recommendation-impact ${rec.impactType}">
                        ${rec.impactType === 'positive' ? 'üí° ' : '‚ö†Ô∏è '}${rec.impact}
                    </div>
                </div>
            `).join('');
        }

        // Grafik Olu≈üturma Fonksiyonu
        let chartInstances = {};

        // Senaryo Y√∂netimi
        let currentScenario = 'A';
        let scenarioA = null;
        let scenarioB = null;
        let scenarioAResults = null;
        let scenarioBResults = null;

        function createCharts(weekdayDaily, weekdayMonthly, weekendDaily, weekendMonthly, subRevenue, 
                             totalRevenue, staffCost, opCost, rent, totalExpenses, netProfit) {
            
            // Eski grafikleri temizle
            Object.values(chartInstances).forEach(chart => {
                if (chart) chart.destroy();
            });
            chartInstances = {};

            // 1. Hafta ƒ∞√ßi vs Hafta Sonu Hasƒ±lat Kar≈üƒ±la≈ütƒ±rmasƒ±
            const ctx1 = document.getElementById('revenueComparisonChart');
            if (ctx1) {
                chartInstances.revenueComparison = new Chart(ctx1, {
                    type: 'bar',
                    data: {
                        labels: ['G√ºnl√ºk Hasƒ±lat', 'Aylƒ±k Hasƒ±lat'],
                        datasets: [{
                            label: 'Hafta ƒ∞√ßi',
                            data: [weekdayDaily, weekdayMonthly],
                            backgroundColor: 'rgba(102, 126, 234, 0.8)',
                            borderColor: 'rgba(102, 126, 234, 1)',
                            borderWidth: 2
                        }, {
                            label: 'Hafta Sonu',
                            data: [weekendDaily, weekendMonthly],
                            backgroundColor: 'rgba(118, 75, 162, 0.8)',
                            borderColor: 'rgba(118, 75, 162, 1)',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return context.dataset.label + ': ' + 
                                               new Intl.NumberFormat('tr-TR', {style: 'currency', currency: 'TRY'}).format(context.raw);
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return new Intl.NumberFormat('tr-TR', {notation: 'compact', compactDisplay: 'short'}).format(value) + '‚Ç∫';
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // 2. Gider Daƒüƒ±lƒ±mƒ± (Pasta)
            const ctx2 = document.getElementById('expenseDistributionChart');
            if (ctx2) {
                chartInstances.expenseDistribution = new Chart(ctx2, {
                    type: 'doughnut',
                    data: {
                        labels: ['Personel', 'Operasyonel', 'Kira'],
                        datasets: [{
                            data: [staffCost, opCost, rent],
                            backgroundColor: [
                                'rgba(255, 99, 132, 0.8)',
                                'rgba(54, 162, 235, 0.8)',
                                'rgba(255, 206, 86, 0.8)'
                            ],
                            borderColor: [
                                'rgba(255, 99, 132, 1)',
                                'rgba(54, 162, 235, 1)',
                                'rgba(255, 206, 86, 1)'
                            ],
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'bottom'
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        const label = context.label || '';
                                        const value = context.raw || 0;
                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                        const percentage = ((value / total) * 100).toFixed(1);
                                        return label + ': ' + 
                                               new Intl.NumberFormat('tr-TR', {style: 'currency', currency: 'TRY'}).format(value) +
                                               ' (' + percentage + '%)';
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // 3. Gelir vs Gider Kar≈üƒ±la≈ütƒ±rmasƒ±
            const ctx3 = document.getElementById('incomeExpenseChart');
            if (ctx3) {
                chartInstances.incomeExpense = new Chart(ctx3, {
                    type: 'bar',
                    data: {
                        labels: ['Aylƒ±k'],
                        datasets: [{
                            label: 'Toplam Gelir',
                            data: [totalRevenue],
                            backgroundColor: 'rgba(75, 192, 192, 0.8)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 2
                        }, {
                            label: 'Toplam Gider',
                            data: [totalExpenses],
                            backgroundColor: 'rgba(255, 99, 132, 0.8)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 2
                        }, {
                            label: 'Net Kar',
                            data: [netProfit],
                            backgroundColor: netProfit > 0 ? 'rgba(40, 167, 69, 0.8)' : 'rgba(220, 53, 69, 0.8)',
                            borderColor: netProfit > 0 ? 'rgba(40, 167, 69, 1)' : 'rgba(220, 53, 69, 1)',
                            borderWidth: 2
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return context.dataset.label + ': ' + 
                                               new Intl.NumberFormat('tr-TR', {style: 'currency', currency: 'TRY'}).format(context.raw);
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return new Intl.NumberFormat('tr-TR', {notation: 'compact', compactDisplay: 'short'}).format(value) + '‚Ç∫';
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // 4. 12 Aylƒ±k Projeksiyonu (√áizgi Grafik)
            const ctx4 = document.getElementById('yearlyProjectionChart');
            if (ctx4) {
                const months = ['Oca', '≈ûub', 'Mar', 'Nis', 'May', 'Haz', 'Tem', 'Aƒüu', 'Eyl', 'Eki', 'Kas', 'Ara'];
                const monthlyData = months.map(() => netProfit);
                const cumulativeData = months.map((_, i) => netProfit * (i + 1));
                
                chartInstances.yearlyProjection = new Chart(ctx4, {
                    type: 'line',
                    data: {
                        labels: months,
                        datasets: [{
                            label: 'Aylƒ±k Kar/Zarar',
                            data: monthlyData,
                            borderColor: netProfit > 0 ? 'rgba(40, 167, 69, 1)' : 'rgba(220, 53, 69, 1)',
                            backgroundColor: netProfit > 0 ? 'rgba(40, 167, 69, 0.1)' : 'rgba(220, 53, 69, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }, {
                            label: 'K√ºm√ºlatif Kar/Zarar',
                            data: cumulativeData,
                            borderColor: 'rgba(102, 126, 234, 1)',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            borderWidth: 3,
                            fill: true,
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                position: 'top'
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        return context.dataset.label + ': ' + 
                                               new Intl.NumberFormat('tr-TR', {style: 'currency', currency: 'TRY'}).format(context.raw);
                                    }
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    callback: function(value) {
                                        return new Intl.NumberFormat('tr-TR', {notation: 'compact', compactDisplay: 'short'}).format(value) + '‚Ç∫';
                                    }
                                }
                            }
                        }
                    }
                });
            }
        }

        function formatCurrency(value) {
            return new Intl.NumberFormat('tr-TR', {
                style: 'currency',
                currency: 'TRY',
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            }).format(value);
        }

        function generateManagerReport() {
            // T√ºm deƒüerleri tekrar al
            const locationName = document.getElementById('locationName').value || 'Lokasyon';
            const weekdayCapacity = parseFloat(document.getElementById('weekdayCapacity').value) || 0;
            const weekendCapacity = parseFloat(document.getElementById('weekendCapacity').value) || 0;
            const workingDays = parseFloat(document.getElementById('workingDays').value) || 22;
            
            // Maliyetler
            const investmentCostValue = document.getElementById('investmentCost').value.replace(/\./g, '').replace(/,/g, '.');
            const investmentCost = parseFloat(investmentCostValue) || 0;
            const amortizationMonths = parseFloat(document.getElementById('amortizationMonths').value) || 36;
            const rentRate = parseFloat(document.getElementById('rentRate').value) || 35;
            
            // Personel
            const staffCount = parseFloat(document.getElementById('staffCountTotal').value) || 0;
            const staffCostTotalValue = document.getElementById('staffCostTotal').value.replace(/\./g, '').replace(/,/g, '.');
            const monthlyStaffCost = parseFloat(staffCostTotalValue) || 0;
            
            // Hesaplamalarƒ± yeniden yap
            const personelSubs = parseFloat(document.getElementById('personelSubs').value) || 0;
            const personelPrice = parseFloat(document.getElementById('personelPrice').value) || 0;
            const externalSubs = parseFloat(document.getElementById('externalSubs').value) || 0;
            const externalPrice = parseFloat(document.getElementById('externalPrice').value) || 0;
            const monthlySubRevenue = (personelSubs * personelPrice) + (externalSubs * externalPrice);
            
            let weekdayDailyRevenue = 0;
            for (let i = 1; i <= 6; i++) {
                const tariff = parseFloat(document.getElementById(`wd_slot${i}_tariff`).value) || 0;
                const parking = parseFloat(document.getElementById(`wd_slot${i}_parking`).value) || 0;
                weekdayDailyRevenue += tariff * parking;
            }
            
            const weekendDays = parseFloat(document.getElementById('weekendDays').value) || 8;
            let weekendDailyRevenue = 0;
            for (let i = 1; i <= 6; i++) {
                const tariff = parseFloat(document.getElementById(`we_slot${i}_tariff`).value) || 0;
                const parking = parseFloat(document.getElementById(`we_slot${i}_parking`).value) || 0;
                weekendDailyRevenue += tariff * parking;
            }
            
            const weekdayMonthlyRevenue = weekdayDailyRevenue * workingDays;
            const weekendMonthlyRevenue = weekendDailyRevenue * weekendDays;
            const totalMonthlyRevenue = weekdayMonthlyRevenue + weekendMonthlyRevenue + monthlySubRevenue;
            const totalYearlyRevenue = totalMonthlyRevenue * 12;
            
            const operationalRate = parseFloat(document.getElementById('operationalRate').value) || 10;
            const monthlyOperationalCost = (totalMonthlyRevenue * operationalRate) / 100;
            const monthlyRent = (totalMonthlyRevenue * rentRate) / 100;
            const totalMonthlyExpenses = monthlyStaffCost + monthlyOperationalCost + monthlyRent;
            const monthlyNetProfit = totalMonthlyRevenue - totalMonthlyExpenses;
            const yearlyNetProfit = monthlyNetProfit * 12;
            const netProfitPercentage = totalMonthlyRevenue > 0 ? (monthlyNetProfit / totalMonthlyRevenue) * 100 : 0;
            const paybackPeriod = monthlyNetProfit > 0 ? investmentCost / monthlyNetProfit : 0;
            
            // Rapor i√ßeriƒüini olu≈ütur
            const profitStatus = monthlyNetProfit > 0 ? '‚úÖ KARLI' : '‚ùå ZARARLI';
            const profitColor = monthlyNetProfit > 0 ? '#28a745' : '#dc3545';
            
            const reportContent = `
                <div class="manager-summary">
                    <h3>üéØ GENEL DEƒûERLENDƒ∞RME</h3>
                    <p><strong>${locationName}</strong> lokasyonu i√ßin yapƒ±lan fizibilite √ßalƒ±≈ümasƒ± sonucunda:</p>
                    <p>‚ñ™ Aylƒ±k Net Kar: <span class="highlight" style="color: ${profitColor}; font-size: 20px;">${formatCurrency(monthlyNetProfit)} (${profitStatus})</span></p>
                    <p>‚ñ™ Yƒ±llƒ±k Net Kar: <span class="highlight" style="color: ${profitColor}; font-size: 20px;">${formatCurrency(yearlyNetProfit)}</span></p>
                    <p>‚ñ™ Kar Marjƒ±: <span class="highlight">${Math.abs(netProfitPercentage).toFixed(1)}%</span></p>
                    <p>‚ñ™ Yatƒ±rƒ±m Geri D√∂n√º≈ü: <span class="highlight">${paybackPeriod > 0 ? paybackPeriod.toFixed(1) + ' ay (' + (paybackPeriod/12).toFixed(1) + ' yƒ±l)' : 'Belirsiz'}</span></p>
                </div>
                
                <div class="manager-summary">
                    <h3>üí∞ HASILAT ANALƒ∞Zƒ∞</h3>
                    <p>‚ñ™ Hafta ƒ∞√ßi G√ºnl√ºk: ${formatCurrency(weekdayDailyRevenue)} ‚Üí Aylƒ±k: ${formatCurrency(weekdayMonthlyRevenue)}</p>
                    <p>‚ñ™ Hafta Sonu G√ºnl√ºk: ${formatCurrency(weekendDailyRevenue)} ‚Üí Aylƒ±k: ${formatCurrency(weekendMonthlyRevenue)}</p>
                    <p>‚ñ™ Abonelik Geliri: ${formatCurrency(monthlySubRevenue)}</p>
                    <p>‚ñ™ <strong>Toplam Aylƒ±k Hasƒ±lat: <span class="highlight">${formatCurrency(totalMonthlyRevenue)}</span></strong></p>
                    <p>‚ñ™ <strong>Toplam Yƒ±llƒ±k Hasƒ±lat: <span class="highlight">${formatCurrency(totalYearlyRevenue)}</span></strong></p>
                </div>
                
                <div class="manager-summary">
                    <h3>üí∏ Gƒ∞DER ANALƒ∞Zƒ∞</h3>
                    <p>‚ñ™ Personel Maliyeti: ${formatCurrency(monthlyStaffCost)} (${staffCount} Personel - KDV'li + Katsayƒ±lƒ±)</p>
                    <p>‚ñ™ Operasyonel Gider: ${formatCurrency(monthlyOperationalCost)} (%${operationalRate})</p>
                    <p>‚ñ™ ƒ∞≈ületmeye Kira: ${formatCurrency(monthlyRent)} (%${rentRate})</p>
                    <p>‚ñ™ <strong>Toplam Aylƒ±k Gider: <span class="highlight">${formatCurrency(totalMonthlyExpenses)}</span></strong></p>
                </div>
                
                <div class="manager-report-grid">
                    <div class="manager-report-card">
                        <h4>Hafta ƒ∞√ßi Kapasite</h4>
                        <div class="value">${weekdayCapacity}</div>
                    </div>
                    <div class="manager-report-card">
                        <h4>Hafta Sonu Kapasite</h4>
                        <div class="value">${weekendCapacity}</div>
                    </div>
                    <div class="manager-report-card">
                        <h4>Personel</h4>
                        <div class="value">${staffCount}</div>
                    </div>
                    <div class="manager-report-card">
                        <h4>Aylƒ±k Hasƒ±lat</h4>
                        <div class="value">${formatCurrency(totalMonthlyRevenue)}</div>
                    </div>
                    <div class="manager-report-card">
                        <h4>Aylƒ±k Gider</h4>
                        <div class="value">${formatCurrency(totalMonthlyExpenses)}</div>
                    </div>
                    <div class="manager-report-card">
                        <h4>Net Kar (Aylƒ±k)</h4>
                        <div class="value" style="color: ${profitColor};">${formatCurrency(monthlyNetProfit)}</div>
                    </div>
                    <div class="manager-report-card">
                        <h4>Geri D√∂n√º≈ü</h4>
                        <div class="value">${paybackPeriod > 0 ? paybackPeriod.toFixed(1) + ' ay' : '-'}</div>
                    </div>
                </div>
            `;
            
            document.getElementById('managerReportContent').innerHTML = reportContent;
            document.getElementById('managerReport').style.display = 'block';
            document.getElementById('managerReport').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // KAYDETME/Y√úKLEME FONKSƒ∞YONLARI
        function getAllFormData() {
            const data = {
                // Genel bilgiler
                locationName: document.getElementById('locationName').value,
                devinim: document.getElementById('devinim').value,
                workingMonths: document.getElementById('workingMonths').value,
                
                // Kapasite
                weekdayCapacity: document.getElementById('weekdayCapacity').value,
                weekendCapacity: document.getElementById('weekendCapacity').value,
                workingDays: document.getElementById('workingDays').value,
                weekendDays: document.getElementById('weekendDays').value,
                
                // Personel
                staffMinWage: document.getElementById('staffMinWage').value,
                staff25k: document.getElementById('staff25k').value,
                staffManager: document.getElementById('staffManager').value,
                
                // Maliyet
                investmentCost: document.getElementById('investmentCost').value,
                amortizationMonths: document.getElementById('amortizationMonths').value,
                operationalRate: document.getElementById('operationalRate').value,
                rentRate: document.getElementById('rentRate').value,
                
                // Abonelik
                personelSubs: document.getElementById('personelSubs').value,
                personelPrice: document.getElementById('personelPrice').value,
                externalSubs: document.getElementById('externalSubs').value,
                externalPrice: document.getElementById('externalPrice').value,
                
                // Hafta i√ßi tarifeler
                weekdaySlots: [],
                // Hafta sonu tarifeler
                weekendSlots: []
            };
            
            // Hafta i√ßi saat dilimlerini topla
            for (let i = 1; i <= 6; i++) {
                data.weekdaySlots.push({
                    hours: document.getElementById(`wd_slot${i}_hours`).value,
                    tariff: document.getElementById(`wd_slot${i}_tariff`).value,
                    usage: document.getElementById(`wd_slot${i}_usage`).value,
                    parking: document.getElementById(`wd_slot${i}_parking`).value
                });
            }
            
            // Hafta sonu saat dilimlerini topla
            for (let i = 1; i <= 6; i++) {
                data.weekendSlots.push({
                    hours: document.getElementById(`we_slot${i}_hours`).value,
                    tariff: document.getElementById(`we_slot${i}_tariff`).value,
                    usage: document.getElementById(`we_slot${i}_usage`).value,
                    parking: document.getElementById(`we_slot${i}_parking`).value
                });
            }
            
            return data;
        }

        function setAllFormData(data) {
            // Genel bilgiler
            document.getElementById('locationName').value = data.locationName || '';
            document.getElementById('devinim').value = data.devinim || '1.5';
            document.getElementById('workingMonths').value = data.workingMonths || '12';
            
            // Kapasite
            document.getElementById('weekdayCapacity').value = data.weekdayCapacity || '1670';
            document.getElementById('weekendCapacity').value = data.weekendCapacity || '2505';
            document.getElementById('workingDays').value = data.workingDays || '22';
            document.getElementById('weekendDays').value = data.weekendDays || '8';
            
            // Personel
            document.getElementById('staffMinWage').value = data.staffMinWage || '0';
            document.getElementById('staff25k').value = data.staff25k || '0';
            document.getElementById('staffManager').value = data.staffManager || '0';
            
            // Maliyet
            document.getElementById('investmentCost').value = data.investmentCost || '1.074.165';
            document.getElementById('amortizationMonths').value = data.amortizationMonths || '36';
            document.getElementById('operationalRate').value = data.operationalRate || '10';
            document.getElementById('rentRate').value = data.rentRate || '35';
            
            // Abonelik
            document.getElementById('personelSubs').value = data.personelSubs || '0';
            document.getElementById('personelPrice').value = data.personelPrice || '0';
            document.getElementById('externalSubs').value = data.externalSubs || '0';
            document.getElementById('externalPrice').value = data.externalPrice || '0';
            
            // Hafta i√ßi tarifeler
            if (data.weekdaySlots) {
                data.weekdaySlots.forEach((slot, i) => {
                    const index = i + 1;
                    document.getElementById(`wd_slot${index}_hours`).value = slot.hours || '';
                    document.getElementById(`wd_slot${index}_tariff`).value = slot.tariff || '0';
                    document.getElementById(`wd_slot${index}_usage`).value = slot.usage || '0';
                    document.getElementById(`wd_slot${index}_parking`).value = slot.parking || '0';
                });
            }
            
            // Hafta sonu tarifeler
            if (data.weekendSlots) {
                data.weekendSlots.forEach((slot, i) => {
                    const index = i + 1;
                    document.getElementById(`we_slot${index}_hours`).value = slot.hours || '';
                    document.getElementById(`we_slot${index}_tariff`).value = slot.tariff || '0';
                    document.getElementById(`we_slot${index}_usage`).value = slot.usage || '0';
                    document.getElementById(`we_slot${index}_parking`).value = slot.parking || '0';
                });
            }
            
            // Otomatik hesaplamalarƒ± tetikle
            calculateTotalStaffCost();
            calculateWeekendCapacity();
        }

        function saveCalculation() {
            document.getElementById('saveModal').style.display = 'block';
            document.getElementById('saveName').value = document.getElementById('locationName').value || '';
        }

        function closeSaveModal() {
            document.getElementById('saveModal').style.display = 'none';
        }

        function confirmSave() {
            const saveName = document.getElementById('saveName').value.trim();
            if (!saveName) {
                alert('L√ºtfen bir kayƒ±t adƒ± girin!');
                return;
            }
            
            const data = getAllFormData();
            const savedCalculations = JSON.parse(localStorage.getItem('parkexpertCalculations') || '[]');
            
            const calculation = {
                id: Date.now(),
                name: saveName,
                data: data,
                savedAt: new Date().toISOString()
            };
            
            savedCalculations.push(calculation);
            localStorage.setItem('parkexpertCalculations', JSON.stringify(savedCalculations));
            
            closeSaveModal();
            alert('‚úÖ Hesaplama ba≈üarƒ±yla kaydedildi!');
        }

        function showLoadModal() {
            const savedCalculations = JSON.parse(localStorage.getItem('parkexpertCalculations') || '[]');
            const listContainer = document.getElementById('savedCalculationsList');
            
            if (savedCalculations.length === 0) {
                listContainer.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìÇ</div>
                        <h3>Hen√ºz kayƒ±tlƒ± hesaplama yok</h3>
                        <p>Hesaplamalarƒ±nƒ±zƒ± kaydetmek i√ßin "üíæ Hesaplamayƒ± Kaydet" butonunu kullanƒ±n.</p>
                    </div>
                `;
            } else {
                listContainer.innerHTML = savedCalculations.reverse().map(calc => {
                    const date = new Date(calc.savedAt);
                    const dateStr = date.toLocaleDateString('tr-TR', { 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                    
                    return `
                        <div class="saved-calculation">
                            <h3>${calc.name}</h3>
                            <div class="saved-calculation-info">
                                <span>üìÖ ${dateStr}</span>
                                <span>üìç ${calc.data.locationName || 'Belirtilmemi≈ü'}</span>
                                <span>üöó ${calc.data.weekdayCapacity || 0} Kapasite</span>
                            </div>
                            <div class="saved-calculation-actions">
                                <button class="btn-load" onclick="loadCalculation(${calc.id})">
                                    üìÇ Y√ºkle
                                </button>
                                <button class="btn-delete" onclick="deleteCalculation(${calc.id})">
                                    üóëÔ∏è Sil
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');
            }
            
            document.getElementById('loadModal').style.display = 'block';
        }

        function closeLoadModal() {
            document.getElementById('loadModal').style.display = 'none';
        }

        function loadCalculation(id) {
            const savedCalculations = JSON.parse(localStorage.getItem('parkexpertCalculations') || '[]');
            const calculation = savedCalculations.find(c => c.id === id);
            
            if (calculation) {
                setAllFormData(calculation.data);
                closeLoadModal();
                alert('‚úÖ Hesaplama y√ºklendi!');
                
                // Sayfayƒ± en √ºste kaydƒ±r
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function deleteCalculation(id) {
            if (!confirm('Bu hesaplamayƒ± silmek istediƒüinizden emin misiniz?')) {
                return;
            }
            
            let savedCalculations = JSON.parse(localStorage.getItem('parkexpertCalculations') || '[]');
            savedCalculations = savedCalculations.filter(c => c.id !== id);
            localStorage.setItem('parkexpertCalculations', JSON.stringify(savedCalculations));
            
            showLoadModal(); // Listeyi yenile
            alert('‚úÖ Hesaplama silindi!');
        }

        // EXPORT FONKSƒ∞YONLARI

        function exportToExcel() {
            const data = getAllFormData();
            const locationName = document.getElementById('locationName').value || 'Fizibilite';
            
            // Excel dosyasƒ± i√ßin worksheetler
            const wb = XLSX.utils.book_new();
            
            // 1. Genel Bilgiler Sayfasƒ±
            const generalData = [
                ['PARKEXPERT Fƒ∞Zƒ∞Bƒ∞Lƒ∞TE RAPORU'],
                [''],
                ['Lokasyon:', data.locationName],
                ['Tarih:', new Date().toLocaleDateString('tr-TR')],
                [''],
                ['KAPASITE Bƒ∞LGƒ∞LERƒ∞'],
                ['Hafta ƒ∞√ßi Kapasite:', data.weekdayCapacity],
                ['Hafta Sonu Kapasite:', data.weekendCapacity],
                ['Devinim:', data.devinim],
                [''],
                ['√áALI≈ûMA S√úRELERƒ∞'],
                ['Hafta ƒ∞√ßi √áalƒ±≈üƒ±lan G√ºn (Aylƒ±k):', data.workingDays],
                ['Hafta Sonu √áalƒ±≈üƒ±lan G√ºn (Aylƒ±k):', data.weekendDays],
                ['√áalƒ±≈üƒ±lan Ay (Yƒ±llƒ±k):', data.workingMonths]
            ];
            const ws1 = XLSX.utils.aoa_to_sheet(generalData);
            XLSX.utils.book_append_sheet(wb, ws1, 'Genel Bilgiler');
            
            // 2. Personel Sayfasƒ±
            const personnelData = [
                ['PERSONEL Bƒ∞LGƒ∞LERƒ∞'],
                [''],
                ['Kategori', 'Sayƒ±', 'Birim Maliyet', 'Toplam'],
                ['Asgari √úcretli', data.staffMinWage, '52.122,42 ‚Ç∫', (parseInt(data.staffMinWage) * 52122.42).toFixed(2) + ' ‚Ç∫'],
                ['25.000‚Ç∫ √úcretli', data.staff25k, '58.188,24 ‚Ç∫', (parseInt(data.staff25k) * 58188.24).toFixed(2) + ' ‚Ç∫'],
                ['Y√∂netici', data.staffManager, '92.974,20 ‚Ç∫', (parseInt(data.staffManager) * 92974.20).toFixed(2) + ' ‚Ç∫'],
                [''],
                ['TOPLAM PERSONEL:', parseInt(data.staffMinWage) + parseInt(data.staff25k) + parseInt(data.staffManager)],
                ['TOPLAM AYLIK MALƒ∞YET:', document.getElementById('staffCostTotal').value + ' ‚Ç∫']
            ];
            const ws2 = XLSX.utils.aoa_to_sheet(personnelData);
            XLSX.utils.book_append_sheet(wb, ws2, 'Personel');
            
            // 3. Maliyet ve Giderler
            const costData = [
                ['MALƒ∞YET VE Gƒ∞DERLER'],
                [''],
                ['Yatƒ±rƒ±m Maliyeti (KDV Dahil):', data.investmentCost + ' ‚Ç∫'],
                ['Amortisman S√ºresi:', data.amortizationMonths + ' Ay'],
                ['Operasyonel Gider Oranƒ±:', '%' + data.operationalRate],
                ['Kira Oranƒ±:', '%' + data.rentRate]
            ];
            const ws3 = XLSX.utils.aoa_to_sheet(costData);
            XLSX.utils.book_append_sheet(wb, ws3, 'Maliyetler');
            
            // 4. Abonelikler
            const subscriptionData = [
                ['ABONELƒ∞KLER'],
                [''],
                ['Tip', 'Sayƒ±', 'Fiyat', 'Aylƒ±k Toplam'],
                ['Personel Abone', data.personelSubs, data.personelPrice + ' ‚Ç∫', (parseInt(data.personelSubs) * parseInt(data.personelPrice)) + ' ‚Ç∫'],
                ['Dƒ±≈ü Abonelik', data.externalSubs, data.externalPrice + ' ‚Ç∫', (parseInt(data.externalSubs) * parseInt(data.externalPrice)) + ' ‚Ç∫']
            ];
            const ws4 = XLSX.utils.aoa_to_sheet(subscriptionData);
            XLSX.utils.book_append_sheet(wb, ws4, 'Abonelikler');
            
            // 5. Hafta ƒ∞√ßi Tarifeler
            const weekdayTariffsData = [
                ['HAFTA ƒ∞√áƒ∞ TARƒ∞FELER'],
                [''],
                ['Saat Dilimi', 'Tarife (‚Ç∫)', 'Kullanƒ±m %', 'Park/G√ºn']
            ];
            data.weekdaySlots.forEach(slot => {
                weekdayTariffsData.push([slot.hours, slot.tariff, slot.usage, slot.parking]);
            });
            const ws5 = XLSX.utils.aoa_to_sheet(weekdayTariffsData);
            XLSX.utils.book_append_sheet(wb, ws5, 'Hafta ƒ∞√ßi');
            
            // 6. Hafta Sonu Tarifeler
            const weekendTariffsData = [
                ['HAFTA SONU TARƒ∞FELER'],
                [''],
                ['Saat Dilimi', 'Tarife (‚Ç∫)', 'Kullanƒ±m %', 'Park/G√ºn']
            ];
            data.weekendSlots.forEach(slot => {
                weekendTariffsData.push([slot.hours, slot.tariff, slot.usage, slot.parking]);
            });
            const ws6 = XLSX.utils.aoa_to_sheet(weekendTariffsData);
            XLSX.utils.book_append_sheet(wb, ws6, 'Hafta Sonu');
            
            // Excel dosyasƒ±nƒ± indir
            const fileName = `Parkexpert_Fizibilite_${locationName.replace(/[^a-z0-9]/gi, '_')}_${new Date().toISOString().split('T')[0]}.xlsx`;
            XLSX.writeFile(wb, fileName);
            
            alert('‚úÖ Excel dosyasƒ± ba≈üarƒ±yla indirildi!');
        }

        async function exportToPDF() {
            const locationName = document.getElementById('locationName').value || 'Fizibilite Raporu';
            
            try {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                const pageWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                let yPosition = 20;
                
                // Ba≈ülƒ±k
                pdf.setFontSize(20);
                pdf.setTextColor(30, 60, 114);
                pdf.text('üÖøÔ∏è PARKEXPERT Fƒ∞Zƒ∞Bƒ∞Lƒ∞TE RAPORU', pageWidth / 2, yPosition, { align: 'center' });
                
                yPosition += 10;
                pdf.setFontSize(16);
                pdf.setTextColor(102, 126, 234);
                pdf.text(locationName, pageWidth / 2, yPosition, { align: 'center' });
                
                yPosition += 8;
                pdf.setFontSize(10);
                pdf.setTextColor(108, 117, 125);
                pdf.text('Tarih: ' + new Date().toLocaleDateString('tr-TR', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                }), pageWidth / 2, yPosition, { align: 'center' });
                
                yPosition += 15;
                
                // Sonu√ßlar b√∂l√ºm√ºn√º yazdƒ±r
                const resultsElement = document.getElementById('results');
                if (resultsElement && resultsElement.style.display !== 'none') {
                    const canvas = await html2canvas(resultsElement, {
                        scale: 2,
                        useCORS: true,
                        logging: false,
                        backgroundColor: '#ffffff'
                    });
                    
                    const imgData = canvas.toDataURL('image/jpeg', 0.95);
                    const imgWidth = pageWidth - 20;
                    const imgHeight = (canvas.height * imgWidth) / canvas.width;
                    
                    // Yeni sayfa gerekiyorsa ekle
                    if (yPosition + imgHeight > pageHeight - 20) {
                        pdf.addPage();
                        yPosition = 20;
                    }
                    
                    pdf.addImage(imgData, 'JPEG', 10, yPosition, imgWidth, imgHeight);
                    yPosition += imgHeight + 10;
                }
                
                // Grafikleri ekle
                const chartsSection = document.getElementById('chartsSection');
                if (chartsSection && chartsSection.style.display !== 'none') {
                    pdf.addPage();
                    yPosition = 20;
                    
                    pdf.setFontSize(16);
                    pdf.setTextColor(30, 60, 114);
                    pdf.text('üìä Grafik Analizler', pageWidth / 2, yPosition, { align: 'center' });
                    yPosition += 15;
                    
                    const chartContainers = chartsSection.querySelectorAll('.chart-container');
                    
                    for (let i = 0; i < chartContainers.length; i++) {
                        const chartContainer = chartContainers[i];
                        
                        const canvas = await html2canvas(chartContainer, {
                            scale: 2,
                            useCORS: true,
                            logging: false,
                            backgroundColor: '#ffffff'
                        });
                        
                        const imgData = canvas.toDataURL('image/jpeg', 0.95);
                        const imgWidth = (pageWidth - 30) / 2;
                        const imgHeight = (canvas.height * imgWidth) / canvas.width;
                        
                        const xPosition = (i % 2 === 0) ? 10 : pageWidth / 2 + 5;
                        
                        if (i % 2 === 0 && i > 0) {
                            yPosition += imgHeight + 10;
                        }
                        
                        if (yPosition + imgHeight > pageHeight - 20) {
                            pdf.addPage();
                            yPosition = 20;
                        }
                        
                        pdf.addImage(imgData, 'JPEG', xPosition, yPosition, imgWidth, imgHeight);
                        
                        if (i === chartContainers.length - 1 && i % 2 === 0) {
                            yPosition += imgHeight + 10;
                        }
                    }
                }
                
                // Y√∂netici raporunu ekle
                const managerReport = document.getElementById('managerReport');
                if (managerReport && managerReport.style.display !== 'none') {
                    pdf.addPage();
                    yPosition = 20;
                    
                    const canvas = await html2canvas(managerReport, {
                        scale: 2,
                        useCORS: true,
                        logging: false,
                        backgroundColor: '#667eea'
                    });
                    
                    const imgData = canvas.toDataURL('image/jpeg', 0.95);
                    const imgWidth = pageWidth - 20;
                    const imgHeight = (canvas.height * imgWidth) / canvas.width;
                    
                    pdf.addImage(imgData, 'JPEG', 10, yPosition, imgWidth, imgHeight);
                }
                
                // PDF'i kaydet
                const fileName = `Parkexpert_Fizibilite_${locationName.replace(/[^a-z0-9]/gi, '_')}_${new Date().toISOString().split('T')[0]}.pdf`;
                pdf.save(fileName);
                
                alert('‚úÖ PDF dosyasƒ± ba≈üarƒ±yla indirildi!');
            } catch (error) {
                console.error('PDF olu≈üturma hatasƒ±:', error);
                alert('‚ùå PDF olu≈üturulurken bir hata olu≈ütu. L√ºtfen tekrar deneyin.');
            }
        }

        // Modal dƒ±≈üƒ±na tƒ±klayƒ±nca kapat
        window.onclick = function(event) {
            if (event.target.className === 'modal') {
                event.target.style.display = 'none';
            }
        }

        // SENARYO Y√ñNETƒ∞Mƒ∞ FONKSƒ∞YONLARI
        function switchScenario(scenario) {
            currentScenario = scenario;
            
            // Tab g√∂r√ºn√ºmlerini g√ºncelle
            document.getElementById('tabA').classList.toggle('active', scenario === 'A');
            document.getElementById('tabB').classList.toggle('active', scenario === 'B');
            
            // ƒ∞ndikat√∂r√º g√ºncelle
            document.getElementById('scenarioIndicator').textContent = `üìä Aktif: Senaryo ${scenario}`;
            
            // Eƒüer kaydedilmi≈ü senaryo varsa y√ºkle
            const savedScenario = scenario === 'A' ? scenarioA : scenarioB;
            if (savedScenario) {
                setAllFormData(savedScenario);
                
                // Eƒüer sonu√ßlar varsa g√∂ster
                const savedResults = scenario === 'A' ? scenarioAResults : scenarioBResults;
                if (savedResults) {
                    // Sonu√ßlarƒ± yeniden g√∂ster (calculate'i tekrar √ßaƒüƒ±rmadan)
                    document.getElementById('results').style.display = 'block';
                }
            } else {
                // Yeni senaryo i√ßin formu temizle
                clearFormForNewScenario();
            }
        }

        function saveCurrentScenario() {
            const data = getAllFormData();
            const locationName = document.getElementById('locationName').value || 'ƒ∞simsiz Senaryo';
            
            if (currentScenario === 'A') {
                scenarioA = data;
                alert(`‚úÖ Senaryo A kaydedildi: ${locationName}`);
            } else {
                scenarioB = data;
                alert(`‚úÖ Senaryo B kaydedildi: ${locationName}`);
            }
            
            // Hesaplama yapƒ±lmƒ±≈üsa sonu√ßlarƒ± da kaydet
            const resultsDiv = document.getElementById('results');
            if (resultsDiv.style.display !== 'none') {
                // Sonu√ßlarƒ± kaydet (basitle≈ütirilmi≈ü)
                const results = extractCurrentResults();
                if (currentScenario === 'A') {
                    scenarioAResults = results;
                } else {
                    scenarioBResults = results;
                }
            }
        }

        function clearScenario() {
            if (!confirm(`Senaryo ${currentScenario}'yƒ± temizlemek istediƒüinizden emin misiniz?`)) {
                return;
            }
            
            if (currentScenario === 'A') {
                scenarioA = null;
                scenarioAResults = null;
            } else {
                scenarioB = null;
                scenarioBResults = null;
            }
            
            clearFormForNewScenario();
            alert(`‚úÖ Senaryo ${currentScenario} temizlendi!`);
        }

        function clearFormForNewScenario() {
            // Formu default deƒüerlere d√∂nd√ºr
            document.getElementById('locationName').value = '';
            document.getElementById('weekdayCapacity').value = '1670';
            document.getElementById('weekendCapacity').value = '2505';
            document.getElementById('devinim').value = '1.5';
            document.getElementById('workingDays').value = '22';
            document.getElementById('weekendDays').value = '8';
            document.getElementById('workingMonths').value = '12';
            
            // Personel
            document.getElementById('staffMinWage').value = '0';
            document.getElementById('staff25k').value = '0';
            document.getElementById('staffManager').value = '0';
            
            // Sonu√ßlarƒ± gizle
            document.getElementById('results').style.display = 'none';
            document.getElementById('chartsSection').style.display = 'none';
            document.getElementById('managerReport').style.display = 'none';
            
            calculateTotalStaffCost();
            calculateWeekendCapacity();
        }

        function extractCurrentResults() {
            // Mevcut sonu√ßlarƒ± √ßƒ±kar
            const locationName = document.getElementById('locationName').value || 'Lokasyon';
            
            // Result grid'den deƒüerleri √ßek
            const resultCards = document.querySelectorAll('.result-card');
            const results = {
                locationName: locationName,
                values: {}
            };
            
            resultCards.forEach(card => {
                const title = card.querySelector('h3')?.textContent || '';
                const value = card.querySelector('.value')?.textContent || '';
                results.values[title] = value;
            });
            
            return results;
        }

        function compareScenarios() {
            if (!scenarioA || !scenarioB) {
                alert('‚ö†Ô∏è Her iki senaryoyu da kaydetmeniz gerekiyor!\n\n1. Senaryo A\'yƒ± doldurun ve "Bu Senaryoyu Kaydet" tƒ±klayƒ±n\n2. Senaryo B\'ye ge√ßin\n3. Senaryo B\'yi doldurun ve kaydedin\n4. Tekrar "Senaryolarƒ± Kar≈üƒ±la≈ütƒ±r" tƒ±klayƒ±n');
                return;
            }
            
            if (!scenarioAResults || !scenarioBResults) {
                alert('‚ö†Ô∏è Her iki senaryo i√ßin de hesaplama yapmanƒ±z gerekiyor!\n\nHer senaryo i√ßin "Fizibilite Hesapla" butonuna tƒ±klayƒ±n.');
                return;
            }
            
            // Kar≈üƒ±la≈ütƒ±rma tablosu olu≈ütur
            createComparisonTable();
            
            // Kar≈üƒ±la≈ütƒ±rma sonu√ßlarƒ±na scroll
            document.getElementById('comparisonResults').style.display = 'block';
            document.getElementById('comparisonResults').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function createComparisonTable() {
            const resultsA = scenarioAResults.values;
            const resultsB = scenarioBResults.values;
            
            // Net karƒ± bul (string'den sayƒ±ya √ßevir)
            const netProfitA = parseFloat(resultsA['Net Kar']?.replace(/[^\d,-]/g, '').replace(',', '.')) || 0;
            const netProfitB = parseFloat(resultsB['Net Kar']?.replace(/[^\d,-]/g, '').replace(',', '.')) || 0;
            
            const winner = netProfitA > netProfitB ? 'A' : (netProfitB > netProfitA ? 'B' : 'E≈üit');
            
            // Winner badge
            const winnerBadge = document.getElementById('winnerBadge');
            if (winner !== 'E≈üit') {
                winnerBadge.innerHTML = `<div class="winner-badge">üèÜ KAZANAN: SENARYO ${winner}</div>`;
            } else {
                winnerBadge.innerHTML = `<div class="winner-badge" style="background: linear-gradient(135deg, #6c757d 0%, #495057 100%);">‚öñÔ∏è SENARYOLAR E≈ûƒ∞T</div>`;
            }
            
            // Senaryo bilgileri
            const scenarioInfoHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px;">
                    <div class="scenario-info-box">
                        <h3>üìä Senaryo A</h3>
                        <p><strong>Lokasyon:</strong> ${scenarioAResults.locationName}</p>
                        <p><strong>Hafta ƒ∞√ßi Kapasite:</strong> ${scenarioA.weekdayCapacity}</p>
                        <p><strong>Hafta Sonu Kapasite:</strong> ${scenarioA.weekendCapacity}</p>
                    </div>
                    <div class="scenario-info-box">
                        <h3>üìä Senaryo B</h3>
                        <p><strong>Lokasyon:</strong> ${scenarioBResults.locationName}</p>
                        <p><strong>Hafta ƒ∞√ßi Kapasite:</strong> ${scenarioB.weekdayCapacity}</p>
                        <p><strong>Hafta Sonu Kapasite:</strong> ${scenarioB.weekendCapacity}</p>
                    </div>
                </div>
            `;
            
            // Kar≈üƒ±la≈ütƒ±rma tablosu
            let tableHTML = `
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th class="metric-name">Metrik</th>
                            <th>Senaryo A</th>
                            <th>Senaryo B</th>
                            <th>Fark</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            // T√ºm metrikleri kar≈üƒ±la≈ütƒ±r
            const allMetrics = new Set([...Object.keys(resultsA), ...Object.keys(resultsB)]);
            
            allMetrics.forEach(metric => {
                const valueA = resultsA[metric] || '-';
                const valueB = resultsB[metric] || '-';
                
                // Sayƒ±sal deƒüerleri kar≈üƒ±la≈ütƒ±r
                const numA = parseFloat(valueA.replace(/[^\d,-]/g, '').replace(',', '.')) || 0;
                const numB = parseFloat(valueB.replace(/[^\d,-]/g, '').replace(',', '.')) || 0;
                
                let classA = '';
                let classB = '';
                let diff = '-';
                
                if (numA !== 0 && numB !== 0) {
                    if (metric.includes('Gider') || metric.includes('Maliyet')) {
                        // Giderler i√ßin d√º≈ü√ºk olanƒ± ye≈üil
                        classA = numA < numB ? 'better' : (numA > numB ? 'worse' : '');
                        classB = numB < numA ? 'better' : (numB > numA ? 'worse' : '');
                    } else {
                        // Gelir/Kar i√ßin y√ºksek olanƒ± ye≈üil
                        classA = numA > numB ? 'better' : (numA < numB ? 'worse' : '');
                        classB = numB > numA ? 'better' : (numB < numA ? 'worse' : '');
                    }
                    
                    const difference = Math.abs(numA - numB);
                    const percentage = ((difference / Math.max(numA, numB)) * 100).toFixed(1);
                    diff = `${new Intl.NumberFormat('tr-TR').format(difference)} ‚Ç∫ (${percentage}%)`;
                }
                
                tableHTML += `
                    <tr>
                        <td class="metric-name">${metric}</td>
                        <td class="${classA}">${valueA}</td>
                        <td class="${classB}">${valueB}</td>
                        <td>${diff}</td>
                    </tr>
                `;
            });
            
            tableHTML += `
                    </tbody>
                </table>
            `;
            
            document.getElementById('comparisonContent').innerHTML = scenarioInfoHTML + tableHTML;
        }

        // Enter tu≈üu ile hesaplama
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                calculate();
            }
        });
    </script>

    <!-- Kayƒ±tlƒ± Hesaplamalar Modal -->
    <div id="loadModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üìÇ Kayƒ±tlƒ± Hesaplamalar</h2>
                <button class="close-modal" onclick="closeLoadModal()">&times;</button>
            </div>
            <div class="modal-body" id="savedCalculationsList">
                <!-- Buraya JavaScript ile liste gelecek -->
            </div>
        </div>
    </div>

    <!-- Kaydet Modal -->
    <div id="saveModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üíæ Hesaplamayƒ± Kaydet</h2>
                <button class="close-modal" onclick="closeSaveModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label style="font-size: 16px; font-weight: 600; margin-bottom: 10px; display: block;">Kayƒ±t Adƒ±</label>
                    <input type="text" id="saveName" placeholder="√ñrn: Olivium AVM - Ocak 2025" 
                           style="width: 100%; padding: 12px; border: 2px solid #dee2e6; border-radius: 8px; font-size: 14px;">
                </div>
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button class="btn-load" onclick="confirmSave()" style="flex: 1;">
                        üíæ Kaydet
                    </button>
                    <button class="btn-delete" onclick="closeSaveModal()" style="flex: 1; background: #6c757d;">
                        ‚ùå ƒ∞ptal
                    </button>
                </div>
            </div>
        </div>
    </div>

</body>
</html>
